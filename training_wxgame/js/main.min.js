var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n["throw"](t))}catch(e){s(e)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(o,a)}c((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,s=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},BaseUI=function(t){function e(e){var i=t.call(this)||this;return i.skinName=e,i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initData(),this.initView(),this.initEvent(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.checkFit=function(){this.img_bg.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e}(eui.Component);__reflect(BaseUI.prototype,"BaseUI");var MissionItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="MissionItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){if(this.lbl.text=t.name,this.lbl.textColor=16777215,2==t.state)for(var e=1;3>=e;e++)this["star"+e].source=RES.getRes(e<=t.stars?"star_a_png":"star_b_png")},e}(eui.ItemRenderer);__reflect(MissionItemUI.prototype,"MissionItemUI"),window.MissionItemUI=MissionItemUI;var GameBaseUI=function(t){function e(e,i){var n=t.call(this)||this;return n.skinName=e,n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initData(),this.initView(),this.initEvent(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.checkFit=function(){this.img_bg.height=this.img_1.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),this.vo=null},e}(eui.Component);__reflect(GameBaseUI.prototype,"GameBaseUI");var GameOverUI=function(t){function e(e,i){var n=t.call(this,"GameOverSkin")||this;return n.vo=e,n.time=i,n}return __extends(e,t),e.prototype.initView=function(){for(var t=0,e=this.vo.times.length-1;e>=0;e--)this.time<=1e3*this.vo.times[e]&&(t++,this["star"+(this.vo.times.length-e)].source=RES.getRes("star_a_png"));this.vo.stars=t,t>0&&(this.vo.state=2,GameLogic.getInstance().setNextMission(this.vo.type,this.vo.id,1)),console.log("gameover:",this.vo);var i=GameLogic.getInstance().getRecond(this.vo.type,this.vo.id);0!=i&&(this.lbl_best.text="历史最快成绩："+this.getText(i)),(0==i||this.time<i)&&(GameLogic.getInstance().saveLocal(this.vo.type,this.vo.id,this.time),WxApi.getInstance().setHigherScore(this.vo.type,this.vo.id,this.time)),this.time<i&&(this.lbl_fast.visible=!0),this.lbl.text=GameLogic.getInstance().getStringByStar(this.vo.stars),this.lbl_time.text="本局用时："+this.getText(this.time)},e.prototype.getText=function(t){var e=TimeUtil.ParseTime2Format(Math.floor(t/1e3),"m:s"),i=t%1e3,n="";return n=10>i?"00"+i:100>i?"0"+i:i+"",e+":"+n},e.prototype.initEvent=function(){this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e.prototype.clickRestart=function(){GameLogic.getInstance().startGame(this.vo)},e.prototype.clickBack=function(){GameLogic.getInstance().openStart()},e.prototype.clickShare=function(){var t="这次舒尔特注意力训练"+this.vo.name+"关卡我只用了"+this.getText(this.time)+"秒，快来挑战我吧";WxApi.getInstance().share(t)},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e}(BaseUI);__reflect(GameOverUI.prototype,"GameOverUI");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var HttpCommand=function(){function t(){this.api="http://httpbin.org/"}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.testGet=function(){var t="http://122.152.202.220:8044/WXGAPI/GetUserData.ashx",e={type:"Content-Type",value:"application/json;charset=UTF-8"},i={type:"AppKey",value:"shuerte"},n={skybear:"1001:1;101;1:2:3:4"};this.sendRequest(INTERFACEAPI.TESTGET,t,[e,i],n)},t.prototype.testPost=function(){var t=this.api+"post",e={type:"Content-Type",value:"application/json;charset=UTF-8"};this.sendRequest(INTERFACEAPI.TESTPOST,t,[e],null,egret.HttpMethod.POST)},t.prototype.sendRequest=function(t,e,i,n,r){void 0===n&&(n=null),void 0===r&&(r="GET"),console.log("发送消息:",t,e,i,n);var s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.open(e,r);for(var o=0;o<i.length;o++){var a=i[o];s.setRequestHeader(a.type,a.value)}s.once(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),s.once(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),s.once(egret.Event.COMPLETE,function(e){var i=JSON.parse(e.currentTarget.response);if(console.log("收到消息:",t,i),200!=i.code)return void console.log("请求"+t+"失败，错误代码："+i.code);switch(t){case INTERFACEAPI.TESTGET:break;case INTERFACEAPI.TESTPOST:}},this),s.send(n)},t.prototype.onGetIOError=function(t){t.currentTarget.response;console.log("onGetIOError:",t)},t.prototype.onGetProgress=function(t){},t}();__reflect(HttpCommand.prototype,"HttpCommand");var GameEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t.call(this,e,i,n)||this;return r.data=null,r}return __extends(e,t),e.REWARDAD_CLOSE_EVENT="REWARDAD_CLOSE_EVENT",e.OPENRANK="OPENRANK",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var GameLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.initData(),MissionLogic.getInstance().initCharpter(),this.openStart(),WxApi.getInstance().userInfo=platform.getUserInfo(),console.log("userinfo:",WxApi.getInstance().userInfo)},e.prototype.setNextMission=function(t,e,i){var n=this.data[t];if(null!=n){var r=n[e];null!=r&&(r.state=i)}},e.prototype.initData=function(){this.data=[,[],[],[]],this.config=RES.getRes("config_json");var t=WxApi.getInstance().getLocalData(GameConst.localkey_missiondata);if(console.log("initdata:",t,""==t),(null==t||""==t)&&(t=[,[],[],[]]),null!=this.config)for(var e in this.config){var i=this.config[e];if(!(e.length<8)){var n=new TrainMissionVO;n.id=i.id,n.type=i.type,n.des=i.des,n.content=i.content,n.name=i.name,n.times=[];for(var r=i.time.split(":"),s=0;s<r.length;s++)n.times.push(parseInt(r[s]));n.state=1==n.type?0:1,1==n.type&&1==n.id&&(n.state=1),n.stars=0;var o=this.data[n.type][n.id-1];if(null!=o&&2==o.state&&(n.state=1),null!=t){var a=t[n.type];if(null!=a){var c=a[n.id];if(null!=c){for(var h=parseInt(c),l=n.times.length-1;l>=0;l--)h<=1e3*n.times[l]&&n.stars++;0==n.state&&(n.state=n.stars>0?1:0)}}}this.data[n.type].push(n)}}WxApi.getInstance().setLocalData(GameConst.localkey_missiondata,t)},e.prototype.saveLocal=function(t,e,i){var n=WxApi.getInstance().getLocalData(GameConst.localkey_missiondata);console.log("savelocal:",n),null==n&&(n=[,[],[],[]]),null==n[t]&&(n[t]=[]),n[t][e]=i,WxApi.getInstance().setLocalData(GameConst.localkey_missiondata,n)},e.prototype.getRecond=function(t,e){var i=t+"_"+e,n=WxApi.getInstance().getLocalData(i);return(null==n||""==n)&&(n=0),n},e.prototype.openStart=function(){this.main.removeChildren(),this.main.addChild(new StartUI)},e.prototype.startGame=function(t){this.main.removeChildren(),this.main.addChild(new GameUI(t))},e.prototype.openMission=function(){this.main.removeChildren(),this.main.addChild(new MissionUI)},e.prototype.openGrow=function(){this.main.removeChildren(),this.main.addChild(new GrowUI)},e.prototype.getMissionData=function(){return this.data},e.prototype.getStartMission=function(){return this.data[1][2]},e.prototype.getStringByStar=function(t){return this.config["str"+t]},e}(egret.EventDispatcher);__reflect(GameLogic.prototype,"GameLogic");var MissionLogic=function(t){function e(){var e=t.call(this)||this;return e.charpters={},e.crtChapter=1,e.crtMission=102,e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initCharpter=function(){var t=RES.getRes("mission_json"),e=this.crtMission%100;for(var i in t){var n=t[i],r=new CharpterMissionVO;r.missionId=parseInt(n.id),r.title=n.title,r.type=parseInt(n.type),r.content=n.content,r.des=n.des,r.times=n.time,r.setDialog(n.dialog);var s=Math.floor(parseInt(i)/100),o=this.charpters[s];null==o&&(o=new CharpterVO,o.id=s,o.missions=[],s==this.crtChapter?(o.state=1,r.state=e<r.missionId?2:e>r.missionId?0:1):o.state=s<this.crtChapter?2:0),o.missions.push(r),this.charpters[s]=o}},e.prototype.getChaprters=function(){return this.charpters},e.prototype.getMissionsByChapterID=function(t){var e=this.charpters[t];return e.missions},e.prototype.getCrtMissionInCharpter=function(t){var e=this.charpters[t],i=Math.floor(this.crtMission/100);return i==t?this.crtMission%100:e.missions.length},e.prototype.startMissionGame=function(t){GameLogic.getInstance().main.removeChildren();var e=egret.getDefinitionByName("GameUI"+t.type);GameLogic.getInstance().main.addChild(new e(t))},e}(egret.EventDispatcher);__reflect(MissionLogic.prototype,"MissionLogic");var TimerManager=function(){function t(){this.timerFunList=[],this.clipFrameStatus=!0,this.frameList=[],this.init()}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.addTimerCallBack=function(t,e,i){if(void 0===i&&(i=1),!this.checkHasCallBack(t,e)){var n=new TimerVo;n.fun=t,n.time=i,n.totalTime=i,n.thisObj=e,this.timerFunList.push(n)}},t.prototype.checkHasCallBack=function(t,e){for(var i=0;i<this.timerFunList.length;i++){var n=this.timerFunList[i];if(t==n.fun&&e==n.thisObj)return console.warn("on this same fun by TimerManager this: "+egret.getQualifiedClassName(e)+",fun:"+egret.getQualifiedClassName(t)+",please check!!!"),!0}return!1},t.prototype.init=function(){var t=new egret.Timer(1e3);t.addEventListener(egret.TimerEvent.TIMER,this.timerFun,this),t.start()},t.prototype.clipFrameChange=function(){this.clipFrameStatus?GameConst.GameStage.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this):(GameConst.GameStage.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),GameConst.GameStage.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)),this.clipFrameStatus=!this.clipFrameStatus},t.prototype.timerFun=function(t){for(var e=0;e<this.timerFunList.length;e++){var i=this.timerFunList[e],n=i.fun,r=i.thisObj;i.time--,i.time<=0&&(i.time=i.totalTime,n.call(r))}},t.prototype.removeFun=function(t,e){for(var i=this.timerFunList.length-1;i>=0;i--){var n=this.timerFunList[i],r=n.fun,s=n.thisObj;r==t&&e==s&&this.timerFunList.splice(i,1)}},t.prototype.enterFrame=function(){for(var t=(this.frameList.length,0);t<this.frameList.length;t++){var e=this.frameList[t];e.fun.call(e.thisObj)}},t.prototype.addEnterFrame=function(t,e){var i=new frameVo;i.fun=t,i.thisObj=e,this.frameList.push(i)},t.prototype.removeEnterFrame=function(t,e){for(var i=this.frameList.length,n=0;i>n;n++){var r=this.frameList[n];if(t==r.fun&&e==r.thisObj){this.frameList.splice(n,1);break}}},t}();__reflect(TimerManager.prototype,"TimerManager");var TimerVo=function(){function t(){this.totalTime=0,this.time=0}return t}();__reflect(TimerVo.prototype,"TimerVo");var frameVo=function(){function t(){}return t}();__reflect(frameVo.prototype,"frameVo");var DataBase=function(){function t(){}return t}();__reflect(DataBase.prototype,"DataBase");var GameConst=function(){function t(){}return t.web=1,t.version="201808181130",t.localkey_missiondata="localkey_missiondata",t}();__reflect(GameConst.prototype,"GameConst");var INTERFACEAPI;!function(t){t[t.TESTGET=0]="TESTGET",t[t.TESTPOST=1]="TESTPOST"}(INTERFACEAPI||(INTERFACEAPI={}));var WATCHTYPE;!function(t){t[t.THANKS=1]="THANKS"}(WATCHTYPE||(WATCHTYPE={}));var GAMETYPE;!function(t){t[t.SRT=1]="SRT",t[t.SHORTHAND=2]="SHORTHAND"}(GAMETYPE||(GAMETYPE={}));var PlayerConst=function(){function t(){}return t}();__reflect(PlayerConst.prototype,"PlayerConst");var Int64=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._highValue=0,this._lowValue=0,this.cacheString=new Array,this._lowValue=t,this._highValue=e}return Object.defineProperty(t.prototype,"higherUint",{get:function(){return this._highValue},set:function(t){this._highValue!=t&&(this._highValue=t,this.cacheBytes=null,this.cacheString=[])},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lowerUint",{get:function(){return this._lowValue},set:function(t){this._lowValue=t,this._lowValue!=t&&(this.cacheBytes=null,this.cacheString=[])},enumerable:!0,configurable:!0}),t.prototype.fromString=function(t,e){if(void 0===e&&(e=10),!t)return void this.reset();t=t.toLowerCase();for(var i=4294967296,n=0,r=0,s=0;s<t.length;s++){var o=t.charCodeAt(s)-48;o>9&&(o-=39),n=n*e+o,r=r*e+(n/i>>0),n%=i}this._lowValue=n,this._highValue=r,this.cacheString=[],this.cacheString[e]=t,this.cacheBytes=null},t.prototype.fromBytes=function(t,e){void 0===e&&(e=0);try{t.position=e,t.endian==egret.Endian.LITTLE_ENDIAN?(this._lowValue=t.readUnsignedInt(),this._highValue=t.readUnsignedInt()):(this._highValue=t.readUnsignedInt(),this._lowValue=t.readUnsignedInt())}catch(i){return void this.reset()}this.cacheBytes=null,this.cacheString=[]},t.prototype.reset=function(){this._highValue=0,this._lowValue=0,this.cacheBytes=null,this.cacheString=[]},t.prototype.clone=function(){return new t(this._lowValue,this._highValue)},t.prototype.copy=function(t){this.reset(),this._lowValue=t._lowValue,this._highValue=t._highValue},t.prototype.cloneTo=function(e){return null==e&&(e=new t),e.copy(this),e},t.prototype.equals=function(t){return null==t?!1:this._highValue==t._highValue&&this._lowValue==t._lowValue},Object.defineProperty(t.prototype,"bytes",{get:function(){return this.cacheBytes?this.cacheBytes:(this.cacheBytes=new egret.ByteArray,this.cacheBytes.endian=egret.Endian.LITTLE_ENDIAN,this.cacheBytes.writeUnsignedInt(this._lowValue),this.cacheBytes.writeUnsignedInt(this._highValue),this.cacheBytes)},enumerable:!0,configurable:!0}),t.prototype.toNumber=function(){var t=this.toString();return""==t?0:parseInt(t)},t.prototype.toString=function(t){if(void 0===t&&(t=10),2>t||t>36)throw new RangeError("基数参数必须介于 2 到 36 之间；当前值为 "+t+"。");if(this.cacheString[t])return this.cacheString[t];for(var e,i,n,r="",s=this._lowValue,o=this._highValue,a=Math.pow(2,32);0!=o||0!=s;)e=o%t,n=e*a+s,i=n%t,r=i.toString(t)+r,o=(o-e)/t,s=(n-i)/t;return this.cacheString[t]=""==r?"0":r,this.cacheString[t]},t.prototype.parseData=function(t){this._highValue=t.readUnsignedInt(),this._lowValue=t.readUnsignedInt()},t.prototype.toData=function(t){t.writeUnsignedInt(this._highValue),t.writeUnsignedInt(this._lowValue)},t.prototype.gc=function(){this.cacheBytes=null,this.cacheString=null},t}();__reflect(Int64.prototype,"Int64");var FilterUtil=function(){function t(){}return t.getGrayFilter=function(){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getColorFilter=function(){var t=[0,0,0,0,0,0,1,0,0,255,0,0,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getBlurFilter=function(){var t=new egret.BlurFilter(1,1);return[t]},t.getTxtFilter=function(t){return void 0===t&&(t=0),[new egret.GlowFilter(t,1,2,2,4,1,!1,!1)]},t.getDropFilter=function(){var t=3,e=45,i=0,n=1,r=0,s=0,o=1.5,a=1,c=!1,h=!1,l=new egret.DropShadowFilter(t,e,i,n,r,s,o,a,c,h);return[l]},t}();__reflect(FilterUtil.prototype,"FilterUtil");var StringUtil=function(){function t(){}return t.getSwfLangTextFlowVar=function(e,i){return(new egret.HtmlTextParser).parser(t.getSwfLangStrVar(e,i))},t.getSwfLangStrVarByID=function(e,i){if(null==DataBase.strings)return e;var n=DataBase.strings[e];return null==n?e:t.getSwfLangStrVar(n,i)},t.getSwfLangStrVar=function(e,i){var n,r,s;n=e.indexOf("{"),r=e.indexOf("}");for(var o,a,c,h,l=0;-1!=n&&-1!=r;){s=e.substring(n,r+1),o=e.indexOf("@",l);var u=parseInt(e.substring(o+1,e.indexOf(":",o)))-1;if(0/0==u)return"stringError:"+e;a=e.indexOf("!#[",l)+3,a>2&&(c=e.indexOf("]@",l),h=e.substring(a,c),i[u]=t.getSwfLangStr(h+i[u]));var p=i[u].toString();e=e.replace(s,p),l=n+p.length,n=e.indexOf("{",l),r=e.indexOf("}",l)}return e},t.getSwfLangStr=function(t){if(null==DataBase.strings)return t;var e=DataBase.strings[t];return null==e?t:e.toString()},t}();__reflect(StringUtil.prototype,"StringUtil");var TimeUtil=function(){function t(){}return t.getCurrentTime=function(){var t=new Date;return t.getTime()},t.getCrtServerTime=function(){return(new Date).getTime()/1e3+this.offTime},t.getServerDate=function(){return new Date(1e3*t.getCrtServerTime())},t.formatSecondT=function(e){var i=t.ParseTime2Format(Math.floor(e/1e3),"m:s"),n=e%1e3,r="";return r=10>n?"00"+n:100>n?"0"+n:n+"",i+":"+r},t.GetDayInYear=function(t){function e(t){var e=0;return e=1==t||3==t||5==t||7==t||8==t||10==t||12==t?31:4==t||6==t||9==t||11==t?30:r%400==0||r%4==0&&r%100!=0?29:28}for(var i=new Date(t),n=i.getUTCMonth()+1,r=i.getFullYear(),s=i.getDate(),o=0,a=1;n>=a;a++)o+=a==n?s:e(a);return o},t.getSecondInDay=function(t){return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()},t.ParseTime2Format=function(t,e){function i(t){var e=t.toString();return 10>t&&(e="0"+t),e}void 0===e&&(e="h:m:s");var n=Math.floor(t/3600),r=Math.floor(t%3600/60),s=t%3600%60;return-1!=e.indexOf("h")?e=e.replace(/h/g,i(n)):r+=60*n,-1!=e.indexOf("m")?e=e.replace(/m/g,i(r)):-1!=e.indexOf("h")?s+=60*r:s=t,-1!=e.indexOf("s")&&(e=e.replace(/s/g,i(s))),e},t.ParseTime2Date=function(t,e){function i(t){var e=t.toString();return 10>t&&(e="0"+t),e}void 0===e&&(e="Y-M-D h:m:s");var n=new Date(t),r=n.getFullYear(),s=n.getMonth()+1,o=n.getDate(),a=n.getHours(),c=n.getMinutes(),h=n.getSeconds();return-1!=e.indexOf("Y")&&(e=e.replace(/Y/g,i(r))),-1!=e.indexOf("M")&&(e=e.replace(/M/g,i(s))),-1!=e.indexOf("D")&&(e=e.replace(/D/g,i(o))),-1!=e.indexOf("h")&&(e=e.replace(/h/g,i(a))),-1!=e.indexOf("m")&&(e=e.replace(/m/g,i(c))),-1!=e.indexOf("s")&&(e=e.replace(/s/g,i(h))),e},t.ParseTime2Units=function(t){var e="";return t>=86400?e=Math.floor(t/86400)+"天":t>=3600?e=Math.floor(t/3600)+"小时":t>=60?e=Math.floor(t/60)+"分钟":t>0&&(e=t+"秒"),e},t.CreateCD=function(t,e,i,n){void 0===n&&(n=0);var r=new egret.Timer(i,n);return r.addEventListener(egret.TimerEvent.TIMER,t,e),r},t.RemoveCD=function(t,e,i){null!=t&&(t.stop(),t.removeEventListener(egret.TimerEvent.TIMER,e,i))},t}();__reflect(TimeUtil.prototype,"TimeUtil");var WxApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){1==GameConst.web?GameLogic.getInstance().init():this.login(),this.showShareMenu();var t=this.getLocalData("rewardcd");this.starttime=null==t||""==t?null:parseInt(t)},e.prototype.login=function(){var t=this,e=window.wx;null!=e&&e.login({success:function(e){console.log("wxloginsuccess:",e),t.logincode=e.code,GameLogic.getInstance().init()},fail:function(){},complete:function(){}})},e.prototype.share=function(t,i){void 0===t&&(t=null),void 0===i&&(i=null);var n=window.wx;null!=n&&(t=null==t?e.getInstance().shareInfo.share_game_title:t,i=null==i?"":i,this.updateShareMenu(!0),n.shareAppMessage({title:t,imageUrl:e.getInstance().shareInfo.share_game_img,query:i}))},e.prototype.showoff=function(){var t=window.wx;null!=t&&(this.updateShareMenu(!0),t.shareAppMessage({title:PlayerConst.highestScore+"分，不服来战！",imageUrl:e.getInstance().shareInfo.share_group_img,query:e.getInstance().shareInfo.query}))},e.prototype.drawBMP=function(){var t=new egret.DisplayObjectContainer,i=new egret.Bitmap,n=RES.getRes("over_json.game_over_share");i.texture=n,t.addChild(i);var r=new egret.TextField;r.text=e.getInstance().userInfo.nickName,r.width=200,r.height=24,r.size=24,r.textAlign="center",r.fontFamily="SimHei",r.x=t.width-r.width>>1,r.y=310,t.addChild(r);var s=new egret.TextField;s.text=PlayerConst.highestScore+"分",s.width=300,s.height=24,s.size=40,s.textAlign="center",s.fontFamily="SimHei",s.x=t.width-s.width>>1,s.y=352,t.addChild(s);var o=new egret.RenderTexture;return o.drawToTexture(t),new egret.Bitmap(o)},e.prototype.checkShareInfo=function(){var t=this;console.log("checkShareInfo");var e=window.wx;if(null!=e){var i=e.getLaunchOptionsSync();console.log("info:",i),null!=i&&null!=i.shareTicket&&""!=i.shareTicket&&null!=i.query&&"1"==i.query.grouprank&&e.getShareInfo({shareTicket:i.shareTicket,success:function(e){console.log("getShareInfo:success:",e);var n=new GameEvent(GameEvent.OPENRANK);n.data=i.shareTicket,t.dispatchEvent(n)},fail:function(t){console.log("getShareInfo:fail:",t)},complete:function(){console.log("getShareInfo:complete:")}})}},e.prototype.toast=function(t){this.checkWx()&&wx.showToast({title:t,icon:"none",duration:2e3})},e.prototype.showShareMenu=function(t){void 0===t&&(t=null),console.log("showShareMenu:",t),null==t&&(t={share_game_title:"每天练习5分钟，提高孩子注意力",share_game_img:"resource/assets/share.jpg",query:""}),this.shareInfo=t;var e=window.wx;null!=e&&(e.showShareMenu(),this.onShare(),this.initRewardVideoAd(),this.checkShareInfo())},e.prototype.onShare=function(t){void 0===t&&(t="rightup=1");var i=window.wx;null!=i&&(this.updateShareMenu(!0),console.log("onShareAppMessage:",this.shareInfo),i.onShareAppMessage(function(){return{title:e.getInstance().shareInfo.share_game_title,imageUrl:e.getInstance().shareInfo.share_game_img,query:e.getInstance().shareInfo.query}}))},e.prototype.updateShareMenu=function(t){var e=window.wx;null!=e&&(console.log("updateShareMenu:withShareTicket:",t),e.updateShareMenu({withShareTicket:t,success:function(t){console.log("updateShareMenu:success:",t)},fail:function(t){console.log("updateShareMenu:fail:",t)},complete:function(){console.log("updateShareMenu:complete:")}}))},e.prototype.feedBack=function(){var t=window.wx;null!=t&&t.openCustomerServiceConversation({success:function(t){console.log("success:",t)},fail:function(t){console.log("fail:",t)},complete:function(t){console.log("complete:",t)}})},e.prototype.setHigherScore=function(t,e,i){var n=window.wx;if(null!=n){var r="score_"+t+"_"+e;n.setUserCloudStorage({KVDataList:[{key:r,value:i+""}],success:function(t){console.log("setUserCloudStorage:res:",t)},fail:function(t){console.log("setUserCloudStorage:error:",t)},complete:function(){console.log("setUserCloudStorage:complete:")}})}},e.prototype.showBanner=function(){if(console.log("系统信息：",wx.getSystemInfoSync()),null==this.bannerAd){var t=wx.getSystemInfoSync().screenWidth,e=wx.getSystemInfoSync().screenHeight;this.bannerAd=wx.createBannerAd({adUnitId:"adunit-465b0f38397b8e3f",style:{left:10,top:e-100,width:t-20}})}null!=this.bannerAd&&(this.bannerAd.onLoad(function(){console.log("banner 广告加载成功")}),this.bannerAd.show())},e.prototype.hideBanner=function(){null!=this.bannerAd&&this.bannerAd.hide()},e.prototype.initRewardVideoAd=function(){var t=this,e=window.wx;null!=e&&(this.rewardAd=e.createRewardedVideoAd({adUnitId:"adunit-922e89b51b9d9336"}),this.rewardAd.onLoad(function(){console.log("激励视频 广告加载成功")}),this.rewardAd.onError(function(t){console.log("rewardAderror:",t)}),this.rewardAd.onClose(function(e){var i;i=e&&e.isEnded||void 0===e?0:1,t.rewardAdCDStart(),t.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,i)}))},e.prototype.rewardAdCDStart=function(){this.starttime=(new Date).getTime(),this.setLocalDataByString("rewardcd",this.starttime+"")},e.prototype.getRewardCD=function(){var t=(new Date).getTime();return null==this.starttime?0:60-Math.floor((t-this.starttime)/1e3)},e.prototype.setLocalDataByObject=function(t,e){var i=JSON.stringify(e);this.setLocalDataByString(t,i)},e.prototype.setLocalDataByString=function(t,e){if(!this.checkWx())return null;try{return wx.setStorageSync(t,e)}catch(i){return null}},e.prototype.showRewardAd=function(t){var e=this;if(this.adtype=t,null!=this.rewardAd)try{this.rewardAd.show()["catch"](function(t){console.log("showRewardAd:",t),e.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)})}catch(i){this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)}else this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)},e.prototype.dispatchGameEvent=function(t,e){console.log("dispatchGameEvent:",t,this.adtype,e);var i=new GameEvent(t);i.data={type:this.adtype,data:e},this.dispatchEvent(i)},e.prototype.checkWx=function(){var t=window.wx;return null!=t},e.prototype.setLocalData=function(t,e){if(!this.checkWx())return null;try{return wx.setStorageSync(t,e)}catch(i){return null}},e.prototype.getLocalData=function(t){if(!this.checkWx())return null;try{return wx.getStorageSync(t)}catch(e){return null}},e.prototype.clearLocalData=function(t){if(!this.checkWx())return null;try{return wx.clearStorageSync(t)}catch(e){return null}},e.prototype.skipToProgram=function(){try{wx.navigateToMiniProgram({appId:"wx5ccf73a5edb50795",extraData:"qiuqiu",success:function(t){console.log("navigateToMiniProgram:",t)},fail:function(t){console.log("navigateToMiniProgram:error:",t)},complete:function(){console.log("navigateToMiniProgram:complete:")}})}catch(t){wx.showToast({title:"该功能暂未开放",icon:"none",duration:2e3})}},e.prototype.postToDataContext=function(t){null!=wx&&(console.log("postToDataContext:",t),wx.getOpenDataContext().postMessage(t))},e}(egret.EventDispatcher);__reflect(WxApi.prototype,"WxApi");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var GameItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.end,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.begin=function(){this.rect_click.fillColor=GameLogic.getInstance().crtClickStr==this.data.id?4389127:16711680,this.rect_click.visible=!0},e.prototype.end=function(){this.rect_click.visible=!1},e.prototype.clear=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.end,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.dataChanged=function(){if(null!=this.data){var t=720/this.data.row;this.width=this.height=this.rect_bg.width=this.rect_bg.height=this.rect_click.width=this.rect_click.height=t-30,this.lbl.size=this.data.size,this.lbl.text=this.data.id+""}},e}(eui.ItemRenderer);__reflect(GameItemUI.prototype,"GameItemUI"),window.MissionItemUI=MissionItemUI;var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var GameUI=function(t){function e(e){var i=t.call(this,"GameSkin")||this;return i.vo=e,i}return __extends(e,t),e.prototype.checkFit=function(){t.prototype.checkFit.call(this),this.img_1.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.initData=function(){switch(this.arr_data=new eui.ArrayCollection,this.vo.type){case 1:this.initType1();break;case 2:this.initType2();break;case 3:this.initType3()}},e.prototype.initType1=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e=0;t>e;e++)this.arr.push(e+1+"");for(var i=Math.sqrt(t),n=this.shuffle(this.arr),r=60,e=0;e<n.length;e++)this.arr_data.addItem({id:n[e],row:i,size:r})},e.prototype.initType2=function(){var t=this.vo.content.indexOf(","),e=-1!=t?",":"";this.arr=this.vo.content.split(e);var i=this.shuffle(this.arr),n=60;2!=this.vo.type||8!=this.vo.id&&9!=this.vo.id||(n=48);for(var r=(this.vo.id<3||this.vo.id>8?5:4,0);r<i.length;r++)this.arr_data.addItem({id:i[r],row:(this.vo.id<3,5),size:n})},e.prototype.initType3=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e="",i=0;t>i;i++){var n=Math.floor(10*Math.random())+"";this.arr.push(n),e+=n}this.lbl_num.visible=!0,this.lbl_num.alpha=1,this.lbl_num.text=e;for(var r=60,i=0;10>i;i++)this.arr_data.addItem({id:i+"",row:5,size:r});this.list.visible=!1},e.prototype.shuffle=function(t){for(var e=t.slice(),i=[];;){var n=Math.floor(Math.random()*e.length);if(i.push(e[n]),e.splice(n,1),0==e.length)break}return i},e.prototype.initView=function(){this.lbl_des.text=this.vo.des,this.list.itemRenderer=GameItemUI,this.list.dataProvider=this.arr_data,this.btn_back.visible=!0},e.prototype.clickStart=function(){var t=this;if(this.gp.visible=!1,3==this.vo.type){egret.clearTimeout(this.timeId);var e=1e3*(parseInt(this.vo.content)-5);this.timeId=egret.setTimeout(function(){egret.Tween.get(t.lbl_num).to({alpha:0},3e3).call(function(){t.lbl_num.visible=!1,t.list.visible=!0,t.start()},t)},this,e)}else this.start()
},e.prototype.start=function(){GameLogic.getInstance().crtclick=0,GameLogic.getInstance().crtClickStr=this.arr[GameLogic.getInstance().crtclick],this.starttime=egret.getTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.enterframe,this)},e.prototype.gameover=function(){var t=egret.getTimer(),e=t-this.starttime;this.addChild(new GameOverUI(this.vo,e))},e.prototype.initEvent=function(){this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e.prototype.clickBack=function(){GameLogic.getInstance().openStart()},e.prototype.itemClick=function(t){var e=(t.itemIndex,t.item.id);t.itemRenderer;GameLogic.getInstance().crtClickStr==e&&(GameLogic.getInstance().crtclick++,GameLogic.getInstance().crtclick>=this.arr.length?this.gameover():GameLogic.getInstance().crtClickStr=this.arr[GameLogic.getInstance().crtclick])},e.prototype.enterframe=function(){var t=egret.getTimer(),e=t-this.starttime,i=TimeUtil.ParseTime2Format(Math.floor(e/1e3),"m:s"),n=e%1e3,r="";r=10>n?"00"+n:100>n?"0"+n:n+"",this.lbl_time.text=i+":"+r},e.prototype.clickMission=function(){GameLogic.getInstance().openMission()},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,GameLogic.getInstance().crtclick=0,egret.clearTimeout(this.timeId),egret.Tween.removeTweens(this.lbl_num),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterframe,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e}(BaseUI);__reflect(GameUI.prototype,"GameUI");var GrowLeftItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GrowLeftItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){this.lbl.text="第"+t.id+"章",this.lbl_state.visible=1!=t.state,this.lbl_state.text=0==t.state?"未解锁":"通关",this.lbl_state.textColor=0==t.state?9436162:16244487,this.rect_state.visible=0==t.state},e.prototype.isSelected=function(t){this.rect_select.visible=t},e}(eui.ItemRenderer);__reflect(GrowLeftItemUI.prototype,"GrowLeftItemUI"),window.GrowLeftItemUI=GrowLeftItemUI;var GrowRightItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GrowRightItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){if(this.lbl_title.text=t.missionId+"."+t.title,null!=t.best?this.lbl_best.text="最好成绩："+TimeUtil.formatSecondT(t.best):this.lbl_best.text="",2==t.state)for(var e=1;5>=e;e++)this["star"+e].source=RES.getRes(e<=t.stars?"star_a_png":"star_b_png");this.rect_state.visible=0==t.state},e.prototype.isSelected=function(t){this.rect_select.visible=t},e}(eui.ItemRenderer);__reflect(GrowRightItemUI.prototype,"GrowRightItemUI"),window.GrowRightItemUI=GrowRightItemUI;var GrowUI=function(t){function e(){return t.call(this,"GrowSkin")||this}return __extends(e,t),e.prototype.initData=function(){this.list_left.itemRenderer=GrowLeftItemUI,this.arr_data_left=new eui.ArrayCollection,this.list_right.itemRenderer=GrowRightItemUI,this.arr_data_right=new eui.ArrayCollection},e.prototype.initView=function(){this.charpters=MissionLogic.getInstance().getChaprters(),this.crtChapter=MissionLogic.getInstance().crtChapter,this.initLeftList()},e.prototype.initLeftList=function(){this.arr_data_left.removeAll();for(var t in this.charpters)this.arr_data_left.addItem(this.charpters[t]);this.list_left.dataProvider=this.arr_data_left,this.list_left.validateNow(),this.list_left.selectedIndex=this.crtChapter-1,this.missions=MissionLogic.getInstance().getMissionsByChapterID(this.crtChapter),this.crtMission=MissionLogic.getInstance().getCrtMissionInCharpter(this.crtChapter),this.initRightList()},e.prototype.initRightList=function(){this.arr_data_right.removeAll();for(var t=0;t<this.missions.length;t++)this.arr_data_right.addItem(this.missions[t]);this.list_right.dataProvider=this.arr_data_right,this.list_right.validateNow(),this.list_right.selectedIndex=this.crtMission,this.clickMission=this.missions[this.crtMission]},e.prototype.initEvent=function(){this.list_left.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemLeftClick,this),this.list_right.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemRightClick,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this)},e.prototype.clickStart=function(){null==this.clickMission,MissionLogic.getInstance().startMissionGame(this.clickMission)},e.prototype.clickBack=function(){GameLogic.getInstance().openStart()},e.prototype.itemLeftClick=function(t){var e=this.list_left.selectedItem;if(0!=e.state){null!=this.crtLeftItem&&this.crtLeftItem.isSelected(!1);var i=this.list_left.selectedIndex;this.crtLeftItem=this.list_left.getElementAt(i),this.crtLeftItem.isSelected(!0),this.missions=e.missions,this.crtMission=MissionLogic.getInstance().getCrtMissionInCharpter(this.crtChapter),this.initRightList()}},e.prototype.itemRightClick=function(t){var e=this.list_right.selectedItem;if(0!=e.state){this.clickMission=e,null!=this.crtRightItem&&this.crtRightItem.isSelected(!1);var i=this.list_right.selectedIndex;this.crtRightItem=this.list_right.getElementAt(i),this.crtRightItem.isSelected(!0)}},e.prototype.clear=function(){t.prototype.clear.call(this),this.list_left.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemLeftClick,this),this.list_right.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemRightClick,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.list_left.dataProvider=null,this.list_right.dataProvider=null,this.arr_data_left=null,this.arr_data_right=null,this.charpters=null,this.missions=null,this.clickMission=null},e}(BaseUI);__reflect(GrowUI.prototype,"GrowUI");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),GameLogic.getInstance().GameStage=this.stage,GameConst.GameStage=this.stage,GameLogic.getInstance().main=this,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),[4,platform.login()];case 2:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){WxApi.getInstance().init()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var MissionUI=function(t){function e(){return t.call(this,"MissionSkin")||this}return __extends(e,t),e.prototype.initData=function(){this.list.itemRenderer=MissionItemUI,this.arr_data=new eui.ArrayCollection},e.prototype.initView=function(){this.data=GameLogic.getInstance().getMissionData(),this.crttype=1,this.initList(3);var t=this.gp_1.y;egret.Tween.get(this.gp_1,{loop:!0}).to({y:t-30},500).to(100).to({y:t},500).wait(300)},e.prototype.initList=function(t){void 0===t&&(t=null);var e=this.data[this.crttype];if(null!=e&&0!=e.length){this.arr_data.removeAll();for(var i=0;i<e.length;i++)this.arr_data.addItem(e[i]);this.list.dataProvider=this.arr_data,this.initBtn(),null!=t&&(this.list.validateNow(),this.list.selectedIndex=t)}},e.prototype.initEvent=function(){this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this);for(var t=1;3>=t;t++)this["btn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this);this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this)},e.prototype.clickBack=function(){GameLogic.getInstance().openStart()},e.prototype.btnClick=function(t){var e=parseInt(t.currentTarget.name);this.crttype!=e&&(this.crttype=e,this.initList(),this.gp_1.visible=1==e)},e.prototype.initBtn=function(){for(var t=1;3>=t;t++){var e=this["btn"+t];null!=e&&(e.filters=this.crttype!=t?FilterUtil.getGrayFilter():null)}},e.prototype.itemClick=function(t){var e=t.itemIndex,i=this.data[this.crttype];if(null!=i&&0!=i.length){var n=i[e];null!=n&&GameLogic.getInstance().startGame(n)}},e.prototype.clear=function(){t.prototype.clear.call(this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this);for(var e=1;3>=e;e++)this["btn"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this);this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),egret.Tween.removeTweens(this.gp_1),this.list.dataProvider=null,this.arr_data=null,this.list=null,this.data=null},e}(BaseUI);__reflect(MissionUI.prototype,"MissionUI");var RankTypeItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankTypeItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.setSelected=function(t){this.rect_bg.fillColor=t?16026375:15924365},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){this.lbl.text=t.name},e}(eui.ItemRenderer);__reflect(RankTypeItemUI.prototype,"RankTypeItemUI"),window.RankTypeItemUI=RankTypeItemUI;var RankUI=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this,"RankSkin")||this;return i.shareticket=e,i.skinName="RankSkin",i}return __extends(e,t),e.prototype.initData=function(){this.list.itemRenderer=RankTypeItemUI,this.arr_data=new eui.ArrayCollection},e.prototype.checkFit=function(){this.rect_bg.height=GameLogic.getInstance().GameStage.stageHeight},e.prototype.initView=function(){this.lbl_title.text=null!=this.shareticket?"群排行榜":"好友排行榜",this.data=GameLogic.getInstance().getMissionData(),this.crttype=1,this.initList(),this.validateNow(),this.initDataContext(),platform.bannerhide()},e.prototype.initList=function(){var t=this.data[this.crttype];if(null!=t&&0!=t.length){this.arr_data.removeAll();for(var e=0;e<t.length;e++)this.arr_data.addItem(t[e]);this.list.dataProvider=this.arr_data,this.initBtn()}},e.prototype.initBtn=function(){for(var t=1;3>=t;t++){var e=this["btn"+t];null!=e&&(e.filters=this.crttype!=t?FilterUtil.getGrayFilter():null)}},e.prototype.initEvent=function(){this.img_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),this.img_rankgp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this)},e.prototype.btnClick=function(t){var e=parseInt(t.currentTarget.name);this.crttype!=e&&(this.crttype=e,this.initList(),this.list.validateNow(),this.updateRank(e,1,this.list.getChildAt(0)))},e.prototype.itemClick=function(t){var e=t.itemIndex,i=this.data[this.crttype];if(console.log("itemclick:",e,i),null!=i&&0!=i.length){var n=i[e];if(null!=n){"score_"+n.type+"_"+n.id;this.updateRank(n.type,n.id,t.itemRenderer)}}},e.prototype.initDataContext=function(){var t=window.platform;if(null!=t.openDataContext){this.bitmapdata=new egret.BitmapData(window.sharedCanvas),this.bitmapdata.$deleteSource=!1;var e=new egret.Texture;e._setBitmapData(this.bitmapdata),this.bmp_context=new egret.Bitmap(e),this.bmp_context.width=GameConst.GameStage.stageWidth,this.bmp_context.height=GameConst.GameStage.stageHeight,this.bmp_context.x=this.bmp_context.y=0,this.addChildAt(this.bmp_context,4),egret.stopTick(this.tickerHandler,this),egret.startTick(this.tickerHandler,this),this.updateRank(1,3,this.list.getChildAt(2))}},e.prototype.updateRank=function(t,e,i){console.log("updateRank:",t,e,i),null!=this.crtItem&&this.crtItem.setSelected(!1),this.crtItem=i,null!=this.crtItem&&this.crtItem.setSelected(!0);var n="score_"+t+"_"+e;WxApi.getInstance().postToDataContext({shareTicket:this.shareticket,userinfo:WxApi.getInstance().userInfo,stageW:GameConst.GameStage.stageWidth,stageH:GameConst.GameStage.stageHeight,rankkey:n,command:"open"})},e.prototype.tickerHandler=function(t){return egret.WebGLUtils.deleteWebGLTexture(this.bitmapdata.webGLTexture),this.bitmapdata.webGLTexture=null,!1},e.prototype.clickGroupRank=function(){WxApi.getInstance().share(null,"grouprank=1")},e.prototype.clickClose=function(){null!=this.parent&&this.parent.removeChild(this)},e.prototype.clear=function(){t.prototype.clear.call(this),platform.bannershow(),this.img_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),this.img_rankgp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),WxApi.getInstance().postToDataContext({command:"close"}),null!=this.bmp_context&&null!=this.bmp_context.parent&&this.bmp_context.parent.removeChild(this.bmp_context),egret.stopTick(this.tickerHandler,this),this.bmp_context=null,this.bitmapdata=null},e}(BaseUI);__reflect(RankUI.prototype,"RankUI"),window.RankUI=RankUI;var StartUI=function(t){function e(){return t.call(this,"StartSkin")||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.rewardCD=function(){var t=WxApi.getInstance().getRewardCD();this.canwatch=0>=t,t>0?(this.lbl_cd.text=TimeUtil.ParseTime2Format(t),this.lbl_cd.visible=!0):this.lbl_cd.text=""},e.prototype.initView=function(){this.rewardCD(),platform.bannershow(),WxApi.getInstance().checkWx()&&(this.button=wx.createGameClubButton({icon:"white",style:{left:10,top:80,width:32,height:32,text:"分享圈"}}))},e.prototype.initEvent=function(){this.btn_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRank,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this),this.btn_mission.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this),this.btn_grow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGrow,this),this.btn_ad.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickReward,this),WxApi.getInstance().addEventListener(GameEvent.OPENRANK,this.openRank,this),TimerManager.getInstance().addTimerCallBack(this.rewardCD,this),WxApi.getInstance().addEventListener(GameEvent.REWARDAD_CLOSE_EVENT,this.watchReward,this)},e.prototype.clickReward=function(){if(!this.canwatch){var t=WxApi.getInstance().getRewardCD();return void WxApi.getInstance().toast("为了保护眼睛，请不要连续观看，"+t+"秒后再来鼓励")}WxApi.getInstance().showRewardAd(WATCHTYPE.THANKS)},e.prototype.watchReward=function(t){t.data.type==WATCHTYPE.THANKS&&0==t.data.data&&WxApi.getInstance().toast("谢谢您的鼓励，我会努力做出更好的游戏来帮助小朋友提高注意力")},e.prototype.clickGrow=function(){WxApi.getInstance().toast("即将推出")},e.prototype.clickRank=function(){this.addChild(new RankUI)},e.prototype.openRank=function(t){var e=null==t?null:t.data;this.addChild(new RankUI(e))},e.prototype.clickShare=function(){WxApi.getInstance().share()},e.prototype.clickMission=function(){GameLogic.getInstance().openMission()},e.prototype.clear=function(){t.prototype.clear.call(this),null!=this.button&&this.button.destroy(),platform.bannerdestroy(),this.btn_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRank,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this),this.btn_mission.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this),this.btn_grow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGrow,this),WxApi.getInstance().removeEventListener(GameEvent.OPENRANK,this.openRank,this),this.btn_ad.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickReward,this),TimerManager.getInstance().removeFun(this.rewardCD,this),WxApi.getInstance().removeEventListener(GameEvent.REWARDAD_CLOSE_EVENT,this.watchReward,this)},e}(BaseUI);__reflect(StartUI.prototype,"StartUI");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.createGameClubButton=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.bannershow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.bannerdestroy=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.bannerhide=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var GamesOverUI=function(t){function e(e,i){var n=t.call(this,"GamesOverSkin")||this;return n.vo=e,n.time=i,n}return __extends(e,t),e.prototype.initView=function(){for(var t=0,e=this.vo.times.length-1;e>=0;e--)this.time<=1e3*this.vo.times[e]&&(t++,this["star"+(this.vo.times.length-e)].source=RES.getRes("star_a_png"));this.vo.stars=t,t>0&&(this.vo.state=2,GameLogic.getInstance().setNextMission(this.vo.type,this.vo.id,1)),console.log("gameover:",this.vo);var i=GameLogic.getInstance().getRecond(this.vo.type,this.vo.id);0!=i&&(this.lbl_best.text="历史最快成绩："+this.getText(i)),(0==i||this.time<i)&&(GameLogic.getInstance().saveLocal(this.vo.type,this.vo.id,this.time),WxApi.getInstance().setHigherScore(this.vo.type,this.vo.id,this.time)),this.time<i&&(this.lbl_fast.visible=!0),this.lbl.text=GameLogic.getInstance().getStringByStar(this.vo.stars),this.lbl_time.text="本局用时："+this.getText(this.time)},e.prototype.getText=function(t){var e=TimeUtil.ParseTime2Format(Math.floor(t/1e3),"m:s"),i=t%1e3,n="";return n=10>i?"00"+i:100>i?"0"+i:i+"",e+":"+n},e.prototype.initEvent=function(){this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e.prototype.clickRestart=function(){GameLogic.getInstance().startGame(this.vo)},e.prototype.clickBack=function(){GameLogic.getInstance().openStart()},e.prototype.clickShare=function(){var t="这次舒尔特注意力训练"+this.vo.name+"关卡我只用了"+this.getText(this.time)+"秒，快来挑战我吧";WxApi.getInstance().share(t)},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e}(BaseUI);__reflect(GamesOverUI.prototype,"GamesOverUI");var GameUI1=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this)},e}(GameBaseUI);__reflect(GameUI1.prototype,"GameUI1");var GameUI2=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI2.prototype,"GameUI2");var GameUI3=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI3.prototype,"GameUI3");var GameUI4=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI4.prototype,"GameUI4");var AvgDialogVO=function(){function t(){}return t}();__reflect(AvgDialogVO.prototype,"AvgDialogVO");var AvgVO=function(){function t(){}return t}();__reflect(AvgVO.prototype,"AvgVO");var CharpterMissionVO=function(){function t(){}return t.prototype.setDialog=function(t){},t}();__reflect(CharpterMissionVO.prototype,"CharpterMissionVO");var CharpterVO=function(){function t(){}return t}();__reflect(CharpterVO.prototype,"CharpterVO");var TrainMissionVO=function(){function t(){}return t}();__reflect(TrainMissionVO.prototype,"TrainMissionVO"),window.Main=Main;