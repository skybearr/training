var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(r,s){function o(t){try{c(i.next(t))}catch(e){s(e)}}function a(t){try{c(i["throw"](t))}catch(e){s(e)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(o,a)}c((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,s&&(o=s[2&n[0]?"return":n[0]?"throw":"next"])&&!(o=o.call(s,n[1])).done)return o;switch(s=0,o&&(n=[0,o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,s=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(i){n=[6,i],s=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,s,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},UserInfo=function(){function t(){}return t}();__reflect(UserInfo.prototype,"UserInfo");var fw;!function(t){var e=function(t){function e(e){var n=t.call(this)||this;return n.tweentype=0,n.skinName=e,n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initData(),this.initView(),this.initEvent(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),null!=this.btn_close&&this.btn_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),null!=this.img_close&&this.img_close.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this)},e.prototype.setParams=function(t){this.args=t.params,this.tweentype=t.tweentype},e.prototype.checkFit=function(){this.height=GameConst.stageHeight,null!=this.img_bg&&(this.img_bg.height=GameConst.stageHeight),null!=this.rect_bg&&(this.rect_bg.height=GameConst.stageHeight)},e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),null!=this.btn_close&&this.btn_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this),null!=this.img_close&&this.img_close.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this)},e.prototype.clickClose=function(){null!=this.parent&&this.parent.removeChild(this)},e}(eui.Component);t.BaseUI=e,__reflect(e.prototype,"fw.BaseUI")}(fw||(fw={}));var MissionItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="MissionItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){if(this.lbl.text=t.name,this.lbl.textColor=16777215,2==t.state)for(var e=1;3>=e;e++)this["star"+e].source=RES.getRes(e<=t.stars?"star_a_png":"star_b_png")},e}(eui.ItemRenderer);__reflect(MissionItemUI.prototype,"MissionItemUI"),window.MissionItemUI=MissionItemUI;var GameBaseUI=function(t){function e(e,n){var i=t.call(this)||this;return i.skinName=e,i.vo=n,i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.checkFit(),this.initData(),this.initView(),this.initEvent(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.checkFit=function(){this.img_bg.height=this.img_1.height=GameConst.stageHeight},e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),this.vo=null},e}(eui.Component);__reflect(GameBaseUI.prototype,"GameBaseUI");var CheckInVO=function(){function t(){this.login_first_today=!0,this.continue_num=0,this.checkin_date=0,this.signed_today=!1}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,null==t||(this.uid=t.uid,this.checkin_date=parseInt(t.checkin_date),this.continue_num=parseInt(t.continue_num),this.update_time=parseInt(t.update_time),this.total_num=parseInt(t.total_num),this.signed_today=TimeUtil.checkToday(this.checkin_date))},enumerable:!0,configurable:!0}),t}();__reflect(CheckInVO.prototype,"CheckInVO");var NoticeVO=function(){function t(){this.version_client="1.1"}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.content=t.content,this.update_time=parseInt(t.update_time),this.version_server=t.version,this.version_client!=this.version_server&&(fw.UIManager.getInstance().openUI(UIConst.NOTICE,null,fw.UITYPE.SECOND),this.version_client=this.version_server)},enumerable:!0,configurable:!0}),t}();__reflect(NoticeVO.prototype,"NoticeVO");var SettingVO=function(){function t(){this.rewardCD=180}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!0,configurable:!0}),t}();__reflect(SettingVO.prototype,"SettingVO");var fw;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.getInstance=function(){return null==this._instance&&(this._instance=new n),this._instance},n.prototype.init=function(){t.GameManager.getInstance().logoOver(),WxApi.getInstance().init()},n.prototype.logoOver=function(){t.UIManager.getInstance().openUI(UIConst.START),t.UIManager.getInstance().showLoading(!WxApi.getInstance().inited)},n.prototype.initSwitchData=function(t){this.switchData=t.split("")},n.prototype.isSwitch=function(t){return null==this.switchData?!1:"1"==this.switchData[t]},n.prototype.getParams=function(t){for(var e=[],n=0;n<t.length;n++)e.push(parseFloat(t[n]));return e},n}(egret.EventDispatcher);t.GameManager=e,__reflect(e.prototype,"fw.GameManager")}(fw||(fw={}));var fw;!function(t){var e=function(){function t(){this.bg_position=0,this.sound_switch=!0,this.sound_effect_switch=!1}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.playBgSound=function(t){this.sound_switch=t,t?(null==this.bgSound&&(this.bgSound=RES.getRes("bgm_1_mp3")),null!=this.bgChannel&&(this.bgChannel.stop(),this.bgChannel=null),this.bgChannel=this.bgSound.play(this.bg_position,0)):null!=this.bgChannel?(this.bg_position=this.bgChannel.position,this.bgChannel.stop(),this.bgChannel=null):this.bg_position=0},t.prototype.hideSound=function(t){t?this.sound_switch&&(null==this.bgSound&&(this.bgSound=RES.getRes("bgm_1_mp3")),null!=this.bgChannel&&(this.bgChannel.stop(),this.bgChannel=null),this.bgChannel=this.bgSound.play(this.bg_position,0),this.bg_position=0):null!=this.bgChannel?(this.bg_position=this.bgChannel.position,this.bgChannel.stop(),this.bgChannel=null):this.bg_position=0},t.prototype.setSoundEffectSwitch=function(t){this.sound_effect_switch=t},t.prototype.playEffectSound=function(t){if(void 0===t&&(t="sound_11_wav"),console.log("playEffectSound:",this.sound_effect_switch),this.sound_switch){var e=RES.getRes(t);if(null!=e){var n=e.play(0,1),i={s:e,c:n},r=function(){this.c.stop(),this.c=null,this.s=null};n.addEventListener(egret.Event.SOUND_COMPLETE,r,i)}}},t}();t.SoundManager=e,__reflect(e.prototype,"fw.SoundManager")}(fw||(fw={}));var TimerManager=function(){function t(){this.timerFunList=[],this.clipFrameStatus=!0,this.frameList=[],this.init()}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.addTimerCallBack=function(t,e,n){if(void 0===n&&(n=1),!this.checkHasCallBack(t,e)){var i=new TimerVo;i.fun=t,i.time=n,i.totalTime=n,i.thisObj=e,this.timerFunList.push(i)}},t.prototype.checkHasCallBack=function(t,e){for(var n=0;n<this.timerFunList.length;n++){var i=this.timerFunList[n];if(t==i.fun&&e==i.thisObj)return console.warn("on this same fun by TimerManager this: "+egret.getQualifiedClassName(e)+",fun:"+egret.getQualifiedClassName(t)+",please check!!!"),!0}return!1},t.prototype.init=function(){var t=new egret.Timer(1e3);t.addEventListener(egret.TimerEvent.TIMER,this.timerFun,this),t.start(),GameConst.GameStage.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)},t.prototype.clipFrameChange=function(){this.clipFrameStatus?GameConst.GameStage.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this):(GameConst.GameStage.removeEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this),GameConst.GameStage.addEventListener(egret.Event.ENTER_FRAME,this.enterFrame,this)),this.clipFrameStatus=!this.clipFrameStatus},t.prototype.timerFun=function(t){for(var e=0;e<this.timerFunList.length;e++){var n=this.timerFunList[e],i=n.fun,r=n.thisObj;n.time--,n.time<=0&&(n.time=n.totalTime,i.call(r))}},t.prototype.removeFun=function(t,e){for(var n=this.timerFunList.length-1;n>=0;n--){var i=this.timerFunList[n],r=i.fun,s=i.thisObj;r==t&&e==s&&this.timerFunList.splice(n,1)}},t.prototype.enterFrame=function(){for(var t=(this.frameList.length,0);t<this.frameList.length;t++){var e=this.frameList[t];e.fun.call(e.thisObj)}},t.prototype.addEnterFrame=function(t,e){var n=new frameVo;n.fun=t,n.thisObj=e,this.frameList.push(n)},t.prototype.removeEnterFrame=function(t,e){for(var n=this.frameList.length,i=0;n>i;i++){var r=this.frameList[i];if(t==r.fun&&e==r.thisObj){this.frameList.splice(i,1);break}}},t}();__reflect(TimerManager.prototype,"TimerManager");var TimerVo=function(){function t(){this.totalTime=0,this.time=0}return t}();__reflect(TimerVo.prototype,"TimerVo");var frameVo=function(){function t(){}return t}();__reflect(frameVo.prototype,"frameVo");var fw;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.init(),t}return __extends(n,e),n.getInstance=function(){return null==this._instance&&(this._instance=new n),this._instance},n.prototype.init=function(){this.secCon=new egret.DisplayObjectContainer,this.broadcastCon=new egret.DisplayObjectContainer,this.fightCon=new egret.DisplayObjectContainer,this.loadingCon=new egret.DisplayObjectContainer,this.avgCon=new egret.DisplayObjectContainer,null!=GameConst.GameStage&&(GameConst.GameStage.addChild(this.secCon),GameConst.GameStage.addChild(this.broadcastCon),GameConst.GameStage.addChild(this.fightCon),GameConst.GameStage.addChild(this.avgCon),GameConst.GameStage.addChild(this.loadingCon))},n.prototype.openUI=function(e,n,i,r){if(void 0===n&&(n=null),void 0===i&&(i=1),void 0===r&&(r=0),i==t.UITYPE.FIRST&&this.is_fst_ui_tween||i==t.UITYPE.SECOND&&this.is_sec_ui_tween)return void console.log("正在打开界面，禁止操作");i==t.UITYPE.FIRST?this.is_fst_ui_tween=!0:this.is_sec_ui_tween=!0;var s=egret.getDefinitionByName(e),o={params:n,tweentype:r},a=new s(o);a.setParams(o),i==t.UITYPE.FIRST?this.openFirstUI(a,r):this.openSecondUI(a,r)},n.prototype.openFirstUI=function(e,n){if(void 0===n&&(n=1),this.main.addChild(e),this.secCon.removeChildren(),0==this.main.numChildren)return void this.openFirstUIFinish();for(;this.main.numChildren>1;)this.main.removeChildAt(0);switch(n){case t.TWEENTYPE.NONE:this.openFirstUIFinish();break;case t.TWEENTYPE.MOVE_OVERRIDE:break;case t.TWEENTYPE.MOVE_PUSH:break;case t.TWEENTYPE.SCALE:EffectUtil.Open(e,this.openFirstUIFinish,this);break;case t.TWEENTYPE.ROTAION:}},n.prototype.openFirstUIFinish=function(){for(this.is_fst_ui_tween=!1;this.main.numChildren>1;)this.main.removeChildAt(0)},n.prototype.openSecondUI=function(e,n){switch(void 0===n&&(n=1),this.secCon.addChild(e),n){case t.TWEENTYPE.NONE:this.openSecondUIFinish();break;case t.TWEENTYPE.MOVE_OVERRIDE:break;case t.TWEENTYPE.MOVE_PUSH:break;case t.TWEENTYPE.SCALE:EffectUtil.Open(e,this.openSecondUIFinish,this);break;case t.TWEENTYPE.ROTAION:}},n.prototype.openSecondUIFinish=function(){this.is_sec_ui_tween=!1},n.prototype.showLoading=function(e,i){void 0===i&&(i=1),e?(null==this.loadingView&&(this.loadingView=new t.LoadingUI),n.getInstance().loadingCon.addChild(this.loadingView),this.loadingView.setLoadType(i)):null!=this.loadingView&&(this.loadingView.reset(),n.getInstance().loadingCon.removeChildren())},n}(egret.EventDispatcher);t.UIManager=e,__reflect(e.prototype,"fw.UIManager")}(fw||(fw={}));var fw;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.sendRequest=function(t,e,n,i,r){void 0===i&&(i=null),void 0===r&&(r="GET"),console.log("发送消息:",t,e,i);var s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.open(e,r);for(var o=0;o<n.length;o++){var a=n[o];s.setRequestHeader(a.type,a.value)}s.once(egret.IOErrorEvent.IO_ERROR,function(e){console.log("IOERROR:",t,e.currentTarget),WxApi.getInstance().toast("HttpIOERROR:"+t)},this),s.once(egret.ProgressEvent.PROGRESS,function(t){},this),s.once(egret.Event.COMPLETE,function(e){var n=JSON.parse(e.currentTarget.response),i=n.code;if(200!=i)console.log("请求--"+t+"--失败，错误代码："+n.code),WxApi.getInstance().toast("HttpFailed:"+t+",  code:"+i);else{console.log("收到消息:",t,n);var r=new HttpEvent(t);r.data=n.data,HttpCommand.getInstance().dispatchEvent(r)}},this),s.send(i)},e}(egret.EventDispatcher);t.HttpManager=e,__reflect(e.prototype,"fw.HttpManager")}(fw||(fw={}));var fw;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.isConnect=!1,e}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.initSocket=function(){this.socket=new egret.WebSocket,this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.socket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.socket.addEventListener(egret.Event.CLOSE,this.socketClose,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onSocketError,this),this.socket.connectByUrl("ws://10.0.0.225:8080/websocket")},e.prototype.onReceiveMessage=function(t){var e=new egret.ByteArray;e.endian=egret.Endian.LITTLE_ENDIAN,this.socket.readBytes(e),console.log("onReceiveMessage:",e)},e.prototype.onSocketOpen=function(t){this.isConnect=!0,console.log("onSocketOpen:")},e.prototype.sendMessage=function(t){console.log("sendMessage:"),1==this.isConnect&&(this.socket.type=egret.WebSocket.TYPE_BINARY,t.position=0,this.socket.writeBytes(t,0,t.bytesAvailable),this.socket.flush())},e.prototype.socketClose=function(t){this.isConnect=!1},e.prototype.stopPingPong=function(){null!=this.timer&&this.timer.reset(),null!=this.timer1&&this.timer1.reset()},e.prototype.startPingPong=function(){null==this.timer&&(this.timer=new egret.Timer(5e3),this.timer.addEventListener(egret.TimerEvent.TIMER,this.sendPingPong,this)),this.timer.start(),this.heartCount=0,null==this.timer1&&(this.timer1=new egret.Timer(6e3),this.timer1.addEventListener(egret.TimerEvent.TIMER,this.t1_handler,this)),this.timer1.start()},e.prototype.t1_handler=function(t){this.heartBool?this.heartCount=0:this.heartCount++},e.prototype.sendPingPong=function(t){this.heartBool&&(this.sendping=(new Date).getTime()),this.heartBool=!1},e.prototype.pong=function(){this.heartBool=!0;(new Date).getTime()-this.sendping},e.prototype.onSocketError=function(t){console.log("onSocketError:",t)},e}(egret.EventDispatcher);t.SocketManager=e,__reflect(e.prototype,"fw.SocketManager")}(fw||(fw={}));var fw;!function(t){var e=function(){function t(){}return t}();t.Definition=e,__reflect(e.prototype,"fw.Definition");var n;!function(t){t[t.FIRST=1]="FIRST",t[t.SECOND=2]="SECOND"}(n=t.UITYPE||(t.UITYPE={}));var i;!function(t){t[t.NONE=0]="NONE",t[t.SCALE=1]="SCALE",t[t.MOVE_OVERRIDE=2]="MOVE_OVERRIDE",t[t.MOVE_PUSH=3]="MOVE_PUSH",t[t.ROTAION=4]="ROTAION"}(i=t.TWEENTYPE||(t.TWEENTYPE={}));var r;!function(t){t[t.RESET=0]="RESET",t[t.CIRCLE=1]="CIRCLE",t[t.LOADING=2]="LOADING"}(r=t.LOADINGTYPE||(t.LOADINGTYPE={}));var s;!function(t){t[t.ACTIVE=1]="ACTIVE",t[t.SHOWOFF=2]="SHOWOFF",t[t.CRTSCORE=3]="CRTSCORE",t[t.PASSIVE=4]="PASSIVE",t[t.GROUPRANK=5]="GROUPRANK",t[t.SCREENSHOT=6]="SCREENSHOT",t[t.INVITE=7]="INVITE",t[t.INVITE_DAILY=8]="INVITE_DAILY"}(s=t.SHARETYPE||(t.SHARETYPE={}));var o;!function(t){t[t.ASC=1]="ASC",t[t.DESC=2]="DESC"}(o=t.RANKSORTTYPE||(t.RANKSORTTYPE={}))}(fw||(fw={}));var BitmapOpenDataContext=function(t){function e(e){void 0===e&&(e=48);var n=t.call(this)||this;n.dis=e,n.bitmapdata=new egret.BitmapData(window.sharedCanvas),n.bitmapdata.$deleteSource=!1;var i=new egret.Texture;return i._setBitmapData(n.bitmapdata),n.texture=i,n.width=GameConst.stageWidth,n.height=GameConst.stageHeight,n}return __extends(e,t),e.prototype.start=function(){egret.stopTick(this.tickerHandler,this),egret.startTick(this.tickerHandler,this)},e.prototype.stop=function(){egret.stopTick(this.tickerHandler,this)},e.prototype.tickerHandler=function(t){var e=egret.getTimer();if(!(null!=this.lasttime&&e-this.lasttime<this.dis))return this.lasttime=e,egret.WebGLUtils.deleteWebGLTexture(this.bitmapdata.webGLTexture),this.bitmapdata.webGLTexture=null,!1},e.prototype.command=function(t,e,n,i,r){void 0===e&&(e=null),void 0===n&&(n="score"),void 0===i&&(i=2),void 0===r&&(r=null),WxApi.getInstance().postMessageToDataContext({userinfo:PlayerConst.userInfo,width:GameConst.stageWidth,height:GameConst.stageHeight,command:t,sortkey:n,sorttype:i,shareTicket:r,params:e})},e.prototype.clear=function(){this.command(UIConst.command_clear),null!=this.parent&&this.parent.removeChild(this),egret.stopTick(this.tickerHandler,this),this.bitmapdata=null},e}(egret.Bitmap);__reflect(BitmapOpenDataContext.prototype,"BitmapOpenDataContext");var fw;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.createView(),t}return __extends(n,e),n.prototype.createView=function(){this.bg=GameUtil.getShape(GameConst.stageWidth,GameConst.stageHeight,0,.1),this.bg.touchEnabled=!0,this.addChild(this.bg),this.tf_progress=GameUtil.createTextField(null,300,GameConst.stageWidth,null,480,100),this.addChild(this.tf_progress)},n.prototype.onProgress=function(t,e){this.tf_progress.text="Loading..."+t+"/"+e},n.prototype.setLoadType=function(e){switch(e){case t.LOADINGTYPE.RESET:return;case t.LOADINGTYPE.CIRCLE:null==this.img_circle?this.createCircle():this.img_circle.visible=!0,egret.Tween.get(this.img_circle,{loop:!0}).to({rotation:360},5e3);break;case t.LOADINGTYPE.LOADING:this.tf_progress.visible=!0}},n.prototype.reset=function(){this.tf_progress.visible=!1,null==this.img_circle?this.createCircle():(this.img_circle.visible=!1,egret.Tween.removeTweens(this.img_circle))},n.prototype.createCircle=function(){this.img_circle=GameUtil.createBitmap("logo_png",null,null,GameConst.stageWidth,GameConst.stageHeight,4,null,null),this.img_circle.anchorOffsetX=this.img_circle.width/2,this.img_circle.anchorOffsetY=this.img_circle.height/2,this.img_circle.x=GameConst.stageWidth/2,this.img_circle.y=GameConst.stageHeight/2,this.addChild(this.img_circle)},n}(egret.Sprite);t.LoadingUI=e,__reflect(e.prototype,"fw.LoadingUI",["RES.PromiseTaskReporter"])}(fw||(fw={}));var fw;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data,e=16777215;1==t.rank?e=16714060:2==t.rank?e=16732951:3==t.rank&&(e=16769303),this.bg_rect.fillColor=t.rank%2==1?2039331:2828848,this.lbl_rank.text=t.rank+"",this.lbl_rank.textColor=e,platform.isdebug()||(this.img_head.source=t.head),this.lbl_name.text=t.name,this.lbl_score.text=t.score+""}},e}(eui.ItemRenderer);t.RankItemUI=e,__reflect(e.prototype,"fw.RankItemUI")}(fw||(fw={})),window.RankItemUI=fw.RankItemUI;var RankTypeItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankTypeItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.setSelected=function(t){this.rect_bg.fillColor=t?16026375:15924365},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){this.lbl.text=t.name},e}(eui.ItemRenderer);__reflect(RankTypeItemUI.prototype,"RankTypeItemUI"),window.RankTypeItemUI=RankTypeItemUI;var fw;!function(t){var e=function(e){function n(){var t=e.call(this,"RankSkin")||this;return t.rankkey="score_1_3",t}return __extends(n,e),n.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),console.log("childrenCreated")},n.prototype.checkFit=function(){this.height=this.rect_bg.height=GameConst.GameStage.stageHeight},n.prototype.setParams=function(t){e.prototype.setParams.call(this,t),this.shareticket=null!=this.args?this.args.shareticket:null,this.openworld=null!=this.args?this.args.openworld:!1},n.prototype.initView=function(){platform.bannerhide(),this.list.itemRenderer=RankTypeItemUI,this.arr_data=new eui.ArrayCollection,this.arr_data1=new eui.ArrayCollection,this.data=GameTrainLogic.getInstance().getMissionData(),this.crttype=1,this.initList(),this.openworld?(this.lbl_tag1.text=null!=this.shareticket?"群排行":"好友排行",this.gp_world.visible=!0,this.lbl_title.visible=!1,this.initOpenRank(),this.list_world.itemRenderer=t.RankItemUI,this.arr_data=new eui.ArrayCollection):(this.lbl_title.text=null!=this.shareticket?"群排行榜":"好友排行榜",this.initOpenRank())},n.prototype.initOpenRank=function(){this.scroller_world.visible=!1,this.ranktype=0,this.img_tag2.alpha=0,this.img_tag1.alpha=1,this.lbl_tag2.textColor=16777215,this.lbl_tag1.textColor=0,null!=this.bmp_context?this.bmp_context.visible=!0:this.initDataContext()},n.prototype.initWorldRank=function(){this.scroller_world.visible=!0,this.ranktype=1,this.img_tag1.alpha=0,this.img_tag2.alpha=1,this.lbl_tag1.textColor=16777215,this.lbl_tag2.textColor=0,null!=this.bmp_context&&(this.bmp_context.visible=!1)},n.prototype.initDataContext=function(){platform.isdebug()||(this.bmp_context=new BitmapOpenDataContext,this.bmp_context.x=this.bmp_context.y=0,this.addChildAt(this.bmp_context,4),this.bmp_context.start(),this.bmp_context.command(UIConst.command_openrank,null,"score_1_3",t.RANKSORTTYPE.ASC))},n.prototype.initEvent=function(){this.img_tag1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickOpenRank,this),this.img_tag2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickWorldRank,this),this.img_rankgp.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),HttpCommand.getInstance().addEventListener(HttpEvent.getWorldRank,this.initWorldData,this),this.btn1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn3.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this)},n.prototype.btnClick=function(t){var e=parseInt(t.currentTarget.name);this.crttype!=e&&(this.crttype=e,this.initList(),this.list.validateNow(),this.updateRank(e,1,this.list.getChildAt(0)))},n.prototype.initList=function(){var t=this.data[this.crttype];if(null!=t&&0!=t.length){this.arr_data1.removeAll();for(var e=0;e<t.length;e++)this.arr_data1.addItem(t[e]);this.list.dataProvider=this.arr_data1,this.initBtn()}},n.prototype.initBtn=function(){for(var t=1;3>=t;t++){var e=this["btn"+t];null!=e&&(e.filters=this.crttype!=t?FilterUtil.getGrayFilter():null)}},n.prototype.updateRank=function(e,n,i){if(console.log("updateRank:",e,n,i),null!=this.crtItem&&this.crtItem.setSelected(!1),this.crtItem=i,null!=this.crtItem&&this.crtItem.setSelected(!0),this.rankkey="score_"+e+"_"+n,0==this.ranktype)this.bmp_context.command(UIConst.command_openrank,null,this.rankkey,t.RANKSORTTYPE.ASC,this.shareticket);else{var r=e+"_"+n;HttpCommand.getInstance().getWorldRank(20,1,r)}},n.prototype.itemClick=function(t){var e=t.itemIndex,n=this.data[this.crttype];if(console.log("itemclick:",e,n),null!=n&&0!=n.length){var i=n[e];if(null!=i){"score_"+i.type+"_"+i.id;this.updateRank(i.type,i.id,t.itemRenderer)}}},n.prototype.initWorldData=function(e){this.arr_data.removeAll();for(var n=e.data,i=0;i<n.length;i++){var r=n[i],s=new t.RankVO;s.rank=i+1,s.head=r.user.avatarurl,s.name=r.user.nickname,s.score=r.score,s.gender=r.user.gender,s.date=r.user.ranking_date,s.score>0&&this.arr_data.addItem(s)}this.list_world.dataProvider=this.arr_data},n.prototype.clickOpenRank=function(){0!=this.ranktype&&this.initOpenRank()},n.prototype.clickWorldRank=function(){1!=this.ranktype&&this.initWorldRank()},n.prototype.clickGroupRank=function(){WxApi.getInstance().buryingPoint(BuryingPoint.bp_grouprank_click),WxApi.getInstance().share(t.SHARETYPE.GROUPRANK)},n.prototype.clear=function(){e.prototype.clear.call(this),this.img_tag1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickOpenRank,this),this.img_tag2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickWorldRank,this),this.img_rankgp.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGroupRank,this),HttpCommand.getInstance().removeEventListener(HttpEvent.getWorldRank,this.initWorldData,this),this.btn1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.btn3.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),null!=this.bmp_context&&(this.bmp_context.clear(),this.bmp_context=null),platform.bannershow(GameConst.bannerId)},n}(t.BaseUI);t.RankUI=e,__reflect(e.prototype,"fw.RankUI")}(fw||(fw={})),window.RankUI=fw.RankUI;var fw;!function(t){var e=function(){function t(){}return t}();t.RankVO=e,__reflect(e.prototype,"fw.RankVO")}(fw||(fw={}));var HttpCommand=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.getToken=function(t){var e=HttpEvent.httpApi+"wx?code="+t+"&appid="+HttpEvent.appid,n={type:"Content-Type",value:"application/json;charset=UTF-8"},i={type:"version",value:HttpEvent.version};fw.HttpManager.getInstance().sendRequest(HttpEvent.getToken,e,[n,i])},e.prototype.postUser=function(t){this.sendRequest(HttpEvent.postUser,"users",t,1)},e.prototype.getUser=function(){this.sendRequest(HttpEvent.getUser,"users")},e.prototype.postProps=function(t,e){var n={type:t+"",num:e+""};this.sendRequest(HttpEvent.postProps,"prop",n,1)},e.prototype.getProps=function(){this.sendRequest(HttpEvent.getProps,"prop")},e.prototype.postWorldRank=function(t,e,n){void 0===e&&(e="0"),void 0===n&&(n="0");var i={sort:e,type:n,score:t+""};this.sendRequest(HttpEvent.postWorldRank,"ranking",i,1)},e.prototype.getWorldRank=function(t,e,n,i){void 0===t&&(t=20),void 0===e&&(e=0),void 0===n&&(n="0"),void 0===i&&(i=1);var r="ranking?sort="+e+"&type="+n+"&p="+i+"&limit="+t;this.sendRequest(HttpEvent.getWorldRank,r)},e.prototype.postMyData=function(t){var e={mydata:t};this.sendRequest(HttpEvent.postMyData,"users/mydata",e,1)},e.prototype.getMyData=function(){this.sendRequest(HttpEvent.getMyData,"users/mydata")},e.prototype.getTurntable=function(){this.sendRequest(HttpEvent.getTurntable,"turntable")},e.prototype.getSkinsAll=function(){this.sendRequest(HttpEvent.getSkinsInfo,"skin/all")},e.prototype.postSkinGet=function(t){var e={skin_id:t+""};this.sendRequest(HttpEvent.postSkinGot,"skin",e,1)},e.prototype.postSkinDefault=function(t){var e={skin_id:t};this.sendRequest(HttpEvent.postSkinDefault,"skin/defaultSkin",e,1)},e.prototype.getSkinsGot=function(t){void 0===t&&(t=null),null==t?this.sendRequest(HttpEvent.getSkinsGot,"skin"):this.sendRequest(HttpEvent.getSkinsGot,"skin?skin_id="+t)},e.prototype.getMissionsAll=function(){this.sendRequest(HttpEvent.getMissionsInfo,"level/all")},e.prototype.postMission=function(t,e,n){void 0===n&&(n="");var i={level_id:t+"",grade:e+"",remark:n};this.sendRequest(HttpEvent.postMission,"level",i,1)},e.prototype.getMissionsPass=function(t){null==t?this.sendRequest(HttpEvent.getMissionsPass,"level"):this.sendRequest(HttpEvent.getMissionsPass,"level?level_id="+t)},e.prototype.getAchievesAll=function(){this.sendRequest(HttpEvent.getAchievesAll,"honor/all")},e.prototype.postAchieve=function(t,e,n){var i={honor_id:t+"",grade:e,remark:n};this.sendRequest(HttpEvent.postAchieve,"honor",i,1)},e.prototype.getAchieveGot=function(){this.sendRequest(HttpEvent.getAchieveGot,"honor")},e.prototype.checkIn=function(){this.sendRequest(HttpEvent.checkIn,"checkin",null,1)},e.prototype.notice=function(){this.sendRequest(HttpEvent.getNotice,"notice")},e.prototype.postInvite=function(t){this.sendRequest(HttpEvent.postInvite,"invite",{share_uid:t},1)},e.prototype.getInvite=function(){this.sendRequest(HttpEvent.getInvite,"invite")},e.prototype.getSetting=function(){this.sendRequest(HttpEvent.getSetting,"setting")},e.prototype.getShareSetting=function(){this.sendRequest(HttpEvent.getShareSetting,"shareinfo")},e.prototype.getAd=function(){this.sendRequest(HttpEvent.getAd,"ad")},e.prototype.sendRequest=function(t,e,n,i){void 0===n&&(n=null),void 0===i&&(i=0),e=HttpEvent.httpApi+e;var r={type:"Content-Type",value:"application/json;charset=UTF-8"},s={type:"token",value:PlayerConst.token},o={type:"version",value:HttpEvent.version};fw.HttpManager.getInstance().sendRequest(t,e,[r,s,o],n,0==i?egret.HttpMethod.GET:egret.HttpMethod.POST)},e}(egret.EventDispatcher);__reflect(HttpCommand.prototype,"HttpCommand");var HttpEvent=function(t){function e(e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var r=t.call(this,e,n,i)||this;return r.data=null,r}return __extends(e,t),e.httpApi="https://common.zhuyuce.com/",e.appid="wxd4950745d08c9e90",e.version="1.0",e.getToken="getToken",e.getUser="getUser",e.postUser="postUser",e.getProps="getProps",e.postProps="postProps",e.getWorldRank="getWorldRank",e.postWorldRank="postWorldRank",e.getMyData="getMyData",e.postMyData="postMyData",e.getTurntable="getTurntable",e.getSkinsInfo="getSkinsInfo",e.postSkinGot="postSkinGot",e.postSkinDefault="postSkinDefault",e.getSkinsGot="getSkinsGot",e.getMissionsInfo="getMissionsInfo",e.postMission="postMission",e.getMissionsPass="getMissionsPass",e.getAchievesAll="getAchievesAll",e.postAchieve="postAchieve",e.getAchieveGot="getAchieveGot",e.checkIn="checkIn",e.getInvite="getInvite",e.getNotice="getNotice",e.postInvite="postInvite",e.getSetting="getSetting",e.getShareSetting="getShareSetting",e.getAd="getAd",e}(egret.Event);__reflect(HttpEvent.prototype,"HttpEvent");var GameEvent=function(t){function e(e,n,i){void 0===n&&(n=!1),void 0===i&&(i=!1);var r=t.call(this,e,n,i)||this;return r.data=null,r}return __extends(e,t),e.REWARDAD_CLOSE_EVENT="REWARDAD_CLOSE_EVENT",e.BANNER_HIDE="BANNER_HIDE",e.PROP_NUM_CHANGE="PROP_NUM_CHANGE",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var AchieveLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initAchieves=function(){this.achieves={},this.achievetypes={},HttpCommand.getInstance().addEventListener(HttpEvent.getAchievesAll,this.achieveAllResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getAchieveGot,this.achieveGotResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.postAchieve,this.achieveGotResponse,this,!1,1)},e.prototype.achieveGotResponse=function(t){this.updateAchieves(t.data)},e.prototype.getAllAchieves=function(){return this.achieves
},e.prototype.achieveAllResponse=function(t){for(var e=t.data,n=0;n<e.length;n++){var i=e[n],r=this.achieves[i.flow_id];null==r&&(r=new AchieveVO,r.id=parseInt(i.flow_id),r.imgurl=i.imgurl,r.title=i.title,r.remark=i.remark),r.type=parseInt(i.extradata1),r.appid=i.appid,r.baseline=parseInt(i.baseline),r.grade=this.achievetypes[r.type],r.reward=i.extradata2.split(";");var s=this.achievetypes[r.type];2!=r.state&&(r.state=s<r.baseline?0:1),this.achieves[r.id]=r}},e.prototype.hasGet=function(t){var e=GameLogic.getInstance().getMyDataValueByID(MYDATA.ACHIEVE_GET),n=null==e?[]:e.split("_");return-1!=n.indexOf(t+"")},e.prototype.getReward=function(t){var e=this.achieves[t];e.state=2;var n=GameLogic.getInstance().getMyDataValueByID(MYDATA.ACHIEVE_GET);null==n||""==n?n=e.id+"":n+="_"+e.id,this.updateAchieve(t,"",""),console.log("getrward:",e);for(var i=0;i<e.reward.length;i++){var r=e.reward[i].split(":");console.log("udpateprop:",r),PropLogic.getInstance().updateProp(parseInt(r[0]),parseInt(r[1]))}},e.prototype.updateAchieves=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=this.achieves[n.flow_id];null==i&&(i=new AchieveVO,i.id=parseInt(n.flow_id),i.imgurl=n.imgurl,i.title=n.title),i.type=parseInt(n.extradata1),i.grade=parseInt(n.grade),i.create_time=parseInt(n.create_time),i.remark=n.remark,i.state=2,this.achieves[i.id]=i}},e.prototype.updateAchieve=function(t,e,n){void 0===n&&(n="");var i=this.achieves[t];null==i?console.log("没有找到成就"+t+"，请联系GM"):HttpCommand.getInstance().postAchieve(t,e,n)},e.prototype.updateAchieveType=function(t,e){(null==e||"NaN"==e.toString())&&(e=0),this.achievetypes[t]=e},e.prototype.getAchieveTypeValue=function(t){return null==this.achievetypes[t]?0:this.achievetypes[t]},e.prototype.initAchieveType=function(){this.updateAchieveType(ACHIEVETYPE.LOGIN_TOTAL,PlayerConst.checkInfo.total_num);var t=parseInt(GameLogic.getInstance().getMyDataValueByID(MYDATA.BEST_SCORE));this.updateAchieveType(ACHIEVETYPE.SCORE_SINGLE,t);var e=parseInt(GameLogic.getInstance().getMyDataValueByID(MYDATA.INVITE_NUM));this.updateAchieveType(ACHIEVETYPE.INVITE_NUM,e);var n=parseInt(GameLogic.getInstance().getMyDataValueByID(MYDATA.REWARD_NUM));this.updateAchieveType(ACHIEVETYPE.REWARDAD_NUM,n)},e.prototype.updateRewardAchieve=function(t){void 0===t&&(t=0);var n,i=GameLogic.getInstance().getMyDataValueByID(MYDATA.REWARD_NUM);n=null==i?1:parseInt(i),GameLogic.getInstance().updateMyDataValue(MYDATA.REWARD_NUM,n),e.getInstance().updateAchieveType(ACHIEVETYPE.REWARDAD_NUM,n)},e}(egret.EventDispatcher);__reflect(AchieveLogic.prototype,"AchieveLogic");var GameLogic=function(t){function e(){var e=t.call(this)||this;return e.mydata={},e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(t){HttpCommand.getInstance().addEventListener(HttpEvent.checkIn,this.checkInResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getNotice,this.noticeResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.postInvite,this.postInviteResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getSetting,this.getSettingResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getShareSetting,this.getShareResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getAd,this.getAdResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getMyData,this.getMyDataResponse,this,!1,1),this.updateCheckInfo(t.checkin),this.updateSetting(t.setting),this.updateMyData(t.mydata),this.checkNotice(),this.checkLoginData()},e.prototype.checkNotice=function(){},e.prototype.checkLoginData=function(){var t=new Date,e=t.getFullYear()+":"+t.getMonth()+":"+t.getDate(),n=e+GameConst.localdata_key_turn,i=WxApi.getInstance().getStorage(n);null==i||""==i?TurnLogic.getInstance().freetimes=1:TurnLogic.getInstance().freetimes=1;var r=WxApi.getInstance().getStorage(GameConst.localdata_key_reward_cd);WxApi.getInstance().starttime=null==r||""==r?null:parseInt(r);var s=e+GameConst.localdata_key_lastlogintime,o=WxApi.getInstance().getStorage(s);""!=o&&(PlayerConst.checkInfo.login_first_today=!1),WxApi.getInstance().setStorage(s,t.getTime()+"")},e.prototype.updateMyDataValue=function(t,e){this.mydata[t]=e,this.PostMyData()},e.prototype.PostMyData=function(){var t="";for(var e in this.mydata)t+=e+":"+this.mydata[e]+";";t=t.slice(0,t.length-1),HttpCommand.getInstance().postMyData(t)},e.prototype.getMyDataValueByID=function(t){return this.mydata[t]},e.prototype.getMyDataResponse=function(t){this.updateMyData(t.data)},e.prototype.updateMyData=function(t){this.mydata={};for(var e=t.split(";"),n=0;n<e.length;n++){var i=e[n],r=i.split(":");this.mydata[r[0]]=r[1]}},e.prototype.clearMyData=function(){HttpCommand.getInstance().postMyData("")},e.prototype.noticeResponse=function(t){PlayerConst.noticeInfo.data=t.data},e.prototype.postInviteResponse=function(t){},e.prototype.getSettingResponse=function(t){this.updateSetting(t.data)},e.prototype.updateSetting=function(t){PlayerConst.settingInfo.data=t},e.prototype.getShareResponse=function(t){},e.prototype.getAdResponse=function(t){},e.prototype.signIn=function(){PlayerConst.checkInfo.signed_today?WxApi.getInstance().toast("今日已签到"):HttpCommand.getInstance().checkIn()},e.prototype.checkInResponse=function(t){this.updateCheckInfo(t.data),PropLogic.getInstance().getReward(DataBase.REWARD_ADD_SIGNIN)},e.prototype.updateCheckInfo=function(t){PlayerConst.checkInfo.data=t},e}(egret.EventDispatcher);__reflect(GameLogic.prototype,"GameLogic");var InviteLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initInvite=function(){this.invites=[],HttpCommand.getInstance().addEventListener(HttpEvent.getInvite,this.getInviteResponse,this,!1,1)},e.prototype.getInviteResponse=function(t){this.invites=[];for(var e=GameLogic.getInstance().getMyDataValueByID(MYDATA.INVITE_GET),n=null==e?[]:e.split("_"),i=t.data,r=0;r<i.length;r++){var s=i[r],o=new InviteVO;o.avatarurl=s.avatarurl,o.name=s.nickname,o.uid=s.uid,o.hasget=-1!=n.indexOf(o.uid),o.coinId1=COINTYPE.HP,o.num1=DataBase.HP_ADD_INVITE,r%5==4&&(o.num1*=2),this.invites.push(o)}},e.prototype.getReward=function(t){for(var e=0;e<this.invites.length;e++){var n=this.invites[e];if(n.uid==t){n.hasget=!0;var i=GameLogic.getInstance().getMyDataValueByID(MYDATA.INVITE_GET);return null==i||""==i?i=n.uid:i+="_"+n.uid,GameLogic.getInstance().updateMyDataValue(MYDATA.INVITE_GET,i),void PropLogic.getInstance().updateProp(n.coinId1,n.num1)}}},e.prototype.getInvites=function(){return this.invites},e}(egret.EventDispatcher);__reflect(InviteLogic.prototype,"InviteLogic");var MissionLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initMissions=function(t){this.missions={},HttpCommand.getInstance().addEventListener(HttpEvent.getMissionsInfo,this.missionAllResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getMissionsPass,this.missionPassResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.postMission,this.missionPassResponse,this,!1,1),this.updatemissions(t)},e.prototype.startGame=function(t){var e=this.getMissionVOById(t);return null==e?void console.log("关卡错误",t):void fw.UIManager.getInstance().openUI(UIConst.GAME,e)},e.prototype.getMissionVOById=function(t){return this.missions[t]},e.prototype.getAllMissions=function(){return this.missions},e.prototype.missionPassResponse=function(t){this.updatemissions(t.data)},e.prototype.missionAllResponse=function(t){var e=GameLogic.getInstance().getMyDataValueByID(MYDATA.MISSION_CRT);console.log("init:",e),this.crt_missionId=null==e?101:parseInt(e);var n=t.data;n.sort(this.sortfun);var i=RES.getRes("mission_json");for(var r in i){var s=i[r],o=new MissionVO;o.id=parseInt(s.id),o.title=s.title,o.type=parseInt(s.type),o.content=s.content,o.des=s.des,o.times=s.time,o.setDialog(s.dialog),this.missions[o.id]=o}for(var a=0;a<n.length;a++){var s=n[a],c=this.missions[s.flow_id];null==c&&(c=new MissionVO,c.id=parseInt(s.flow_id),c.imgurl=s.imgurl,c.name=s.title),c.starline=[];for(var h=s.extradata1.split(":"),l=0;l<h.length;l++)c.starline.push(parseInt(h[l]));c.appid=s.appid,c.baseline=parseInt(s.baseline),console.log("state:",c.id,this.crt_missionId),c.state=c.id<this.crt_missionId?2:c.id==this.crt_missionId?1:0,c.grade=c.grade,this.missions[c.id]=c}},e.prototype.sortfun=function(t,e){return parseInt(t.flow_id)<parseInt(e.flow_id)?-1:1},e.prototype.updatemissions=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=this.missions[n.flow_id];null==i&&(i=new MissionVO,i.id=parseInt(n.flow_id),i.imgurl=n.imgurl,i.name=n.title),i.grade=parseInt(n.grade),i.create_time=parseInt(n.create_time),this.missions[i.id]=i}},e.prototype.updatemission=function(t,e,n){void 0===n&&(n="");var i=this.missions[t];if(null==i)console.log("没有找到关卡"+t+"，请联系GM");else{if(e<=i.grade)return;if(HttpCommand.getInstance().postMission(t,e,n),console.log("updateMission:",i,e),e>=i.baseline&&1==i.state){i.state=2;var r=t+1,s=this.missions[r];null==s&&(r=t-t%100+101),console.log("nextid:",r),s=this.missions[r],null!=s&&(this.crt_missionId=r,s.state=1,console.log("updateCrtMission:",this.crt_missionId),GameLogic.getInstance().updateMyDataValue(MYDATA.MISSION_CRT,this.crt_missionId))}}},e}(egret.EventDispatcher);__reflect(MissionLogic.prototype,"MissionLogic");var PropLogic=function(t){function e(){var e=t.call(this)||this;return e.props={},e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initProps=function(t){this.props={},HttpCommand.getInstance().addEventListener(HttpEvent.getProps,this.propResponse,this,!1,1),this.updateProps(t)},e.prototype.propResponse=function(t){},e.prototype.updateProps=function(t){this.props={};for(var e=0;e<t.length;e++){var n=t[e],i=new PropVO;i.id=parseInt(n.type),i.num=parseInt(n.num),i.extradata1=n.id,i.extradata2=n.uid,this.props[i.id]=i}},e.prototype.getPropNameByID=function(t){if(10>t)return DataBase.COIN_NAME[t];var e=this.getPropByID(t);return null==e?t+"":e.name},e.prototype.updateProp=function(t,e){var n=this.props[t];null!=n?(n.num+e<=0&&(e=-n.num),n.num+=e):(n=new PropVO,n.id=t,0>e&&(e=0),n.num=e,this.props[t]=n);var i=DataBase.COIN_NAME[t]+(e>0?"增加":"减少")+" "+e;WxApi.getInstance().toast(i),HttpCommand.getInstance().postProps(t,e);var r=new GameEvent(GameEvent.PROP_NUM_CHANGE);r.data={id:t,num:e},this.dispatchEvent(r)},e.prototype.getReward=function(t){for(var n=t.split(";"),i=0;i<n.length;i++){var r=n[i].split(":");e.getInstance().updateProp(parseInt(r[0]),parseInt(r[1]))}},e.prototype.getPropByID=function(t){return this.props[t]},e}(egret.EventDispatcher);__reflect(PropLogic.prototype,"PropLogic");var SkinLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initSkins=function(t){this.skins={},HttpCommand.getInstance().addEventListener(HttpEvent.getSkinsInfo,this.skinAllResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.getSkinsGot,this.skinGotResponse,this,!1,1),HttpCommand.getInstance().addEventListener(HttpEvent.postSkinGot,this.skinGotResponse,this,!1,1),this.updateskins(t)},e.prototype.skinGotResponse=function(t){this.updateskins(t.data)},e.prototype.skinAllResponse=function(t){for(var e=t.data,n=0;n<e.length;n++){var i=e[n],r=this.skins[i.id];null==r&&(r=new SkinVO,r.id=parseInt(i.id),r.imgurl=i.imgurl,r.name=i.title),r.appid=i.appid,r.baseline=i.baseline,this.skins[r.id]=r}},e.prototype.updateskins=function(t){for(var e=0;e<t.length;e++){var n=t[e],i=this.skins[n.skin_id];null==i&&(i=new SkinVO,i.id=parseInt(n.skin_id),i.imgurl=n.imgurl,i.name=n.title),i.isdefault="1"==n.is_default,i.create_time=parseInt(n.create_time),this.skins[i.id]=i}},e.prototype.getSkin=function(t){var e=this.skins[t];null==e?console.log("没有找到成就"+t+"，请联系GM"):HttpCommand.getInstance().postSkinGet(t)},e}(egret.EventDispatcher);__reflect(SkinLogic.prototype,"SkinLogic");var TurnLogic=function(t){function e(){var e=t.call(this)||this;return e.turns=[],e.freetimes=0,e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initTurns=function(){this.turns=[],HttpCommand.getInstance().addEventListener(HttpEvent.getTurntable,this.turnResponse,this,!1,1)},e.prototype.turnResponse=function(t){this.updateTurns(t.data)},e.prototype.updateTurns=function(t){this.turns=[];for(var e=0;e<t.length;e++){var n=t[e],i=new TurnVO;i.id=parseInt(n.id),i.appid=n.appid,i.imgurl=n.imgurl,i.num=parseInt(n.num),i.name=n.title,i.type=parseInt(n.type),i.weight=parseInt(n.weights),this.turns.push(i)}this.turns=[];for(var e=0;16>e;e++){var i=new TurnVO;i.id=e+1,i.num=GameUtil.between(10,1e3),i.name="奖励"+i.id,i.weight=GameUtil.between(10,100),this.turns.push(i)}},e.prototype.getTurnVOs=function(){return this.turns},e.prototype.getFreeShareCD=function(){if(0==this.freetimes){var t=86400,e=new Date,n=e.getHours(),i=e.getMinutes(),r=e.getSeconds();return t-3600*n-60*i-r}return 0},e.prototype.setFreeTurn=function(){var t=new Date,e=t.getFullYear()+":"+t.getMonth()+":"+t.getDate(),n=e+GameConst.localdata_key_turn;WxApi.getInstance().setStorage(n,"true"),this.freetimes=0},e}(egret.EventDispatcher);__reflect(TurnLogic.prototype,"TurnLogic");var WxApi=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return this.inited=!1,[4,platform.login()];case 1:return t=n.sent(),this.logincode=t.code,console.log("logincod:",t.code),[4,platform.getUserInfo()];case 2:return e=n.sent(),PlayerConst.userInfo.avatarUrl=e.avatarUrl,PlayerConst.userInfo.city=e.city,PlayerConst.userInfo.country=e.country,PlayerConst.userInfo.gender=parseInt(e.gender),PlayerConst.userInfo.language=e.language,PlayerConst.userInfo.nickname=e.nickName,PlayerConst.userInfo.province=e.province,console.log("获取微信用户信息：",PlayerConst.userInfo),"debug_nickName"==PlayerConst.userInfo.nickname?(PlayerConst.token="1D1C1C1C1C1C181L1L181F1F1C1G1E1F1H1C",HttpCommand.getInstance().once(HttpEvent.postUser,this.postUsersResponse,this),HttpCommand.getInstance().postUser(PlayerConst.userInfo)):(HttpCommand.getInstance().once(HttpEvent.getToken,this.getTokenResponse,this),HttpCommand.getInstance().getToken(this.logincode)),[2]}})})},e.prototype.getTokenResponse=function(t){PlayerConst.token=t.data.token,HttpCommand.getInstance().once(HttpEvent.postUser,this.postUsersResponse,this),HttpCommand.getInstance().postUser(PlayerConst.userInfo)},e.prototype.postUsersResponse=function(t){HttpCommand.getInstance().once(HttpEvent.getUser,this.getUserResponse,this),HttpCommand.getInstance().getUser()},e.prototype.getUserResponse=function(t){PlayerConst.openId=t.data.openid,PlayerConst.appid_server=t.data.appid,PlayerConst.uid=t.data.id,PropLogic.getInstance().initProps(t.data.prop),InviteLogic.getInstance().initInvite(),TurnLogic.getInstance().initTurns(),GameLogic.getInstance().init(t.data),MissionTrainLogic.getInstance().initData(),AchieveLogic.getInstance().initAchieves(),this.share(4),this.initRewardVideoAd(),this.checkLauchOptions(),this.initOver()},e.prototype.initOver=function(){console.log("api与接口初始化ok，可以开始游戏"),this.inited=!0,fw.UIManager.getInstance().showLoading(!1)},e.prototype.checkLauchOptions=function(){var t=platform.getLaunchOptionsSync();console.log("checkLauchOptions",t),null!=t.query&&(null!=t.query.invite&&HttpCommand.getInstance().postInvite(t.query.invite),null!=t.query.grouprank&&null!=t.shareTicket&&""!=t.shareTicket&&fw.UIManager.getInstance().openUI(UIConst.RANK,t.shareTicket))},e.prototype.share=function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null);var i="invite="+PlayerConst.uid;switch(t){case fw.SHARETYPE.ACTIVE:platform.share("每天练习5分钟，提高孩子注意力","resource/assets/share.jpg",i);break;case fw.SHARETYPE.SHOWOFF:platform.share("每天练习5分钟，提高孩子注意力","resource/assets/share.jpg",i);break;case fw.SHARETYPE.CRTSCORE:platform.share(e,"resource/assets/share.jpg",i);break;case fw.SHARETYPE.PASSIVE:platform.showShareMenu(),platform.updateShareMenu(!0),platform.onShareAppMessage("每天练习5分钟，提高孩子注意力","resource/assets/share.jpg",i);break;case fw.SHARETYPE.GROUPRANK:i+="&grouprank=1",platform.share("每天练习5分钟，提高孩子注意力","resource/assets/share.jpg",i);break;case fw.SHARETYPE.INVITE:platform.share("玩了舒尔特方格，我上课注意力变的集中了，你也来试试吧","resource/assets/share.jpg",i);break;case fw.SHARETYPE.INVITE_DAILY:}},e.prototype.connectGM=function(){platform.openCustomerServiceConversation()},e.prototype.createGameClubButton=function(t){void 0===t&&(t="游戏圈"),platform.createGameClubButton(t)},e.prototype.vibrate=function(t){void 0===t&&(t=!0),platform.vibrate(t)},e.prototype.skipToProgram=function(t,e){platform.skipToProgram(t,e)},e.prototype.setUserCloudStorage=function(t){platform.setUserCloudStorage(t)},e.prototype.setScore=function(t,e,n){HttpCommand.getInstance().postWorldRank(n,"1",t+"_"+e);var i="score_"+t+"_"+e,r=[{key:i,value:n+""}];this.setUserCloudStorage(r)},e.prototype.setStorage=function(t,e,n){void 0===n&&(n=!1),platform.setStorageSync(t,e,n)},e.prototype.getStorage=function(t,e){return void 0===e&&(e=!1),platform.getStorageSync(t,e)},e.prototype.postMessageToDataContext=function(t){platform.postMessage(t)},e.prototype.initBuryingSDK=function(){platform.initBuryingSDK()},e.prototype.buryingPoint=function(t,e){void 0===e&&(e=null),platform.buryingPoint(t,e)},e.prototype.toast=function(t,e,n,i){void 0===e&&(e=1),void 0===n&&(n="友情提示"),void 0===i&&(i="确定"),1==e?platform.toast(t):2==e&&platform.showModal(t,n,i)},e.prototype.bannershow=function(){platform.bannershow(GameConst.bannerId)},e.prototype.bannerhide=function(){platform.bannerhide()},e.prototype.bannerdestroy=function(){platform.bannerdestroy()},e.prototype.getOpenDataBMP=function(){return platform.isdebug()?null:void 0},e.prototype.rewardAdCDStart=function(){this.starttime=(new Date).getTime(),this.setStorage(GameConst.localdata_key_reward_cd,this.starttime+"")},e.prototype.getRewardCD=function(){var t=(new Date).getTime();return null==this.starttime?0:PlayerConst.settingInfo.rewardCD-Math.floor((t-this.starttime)/1e3)},e.prototype.initRewardVideoAd=function(){var t=this,e=window.wx;null!=e&&(this.rewardAd=e.createRewardedVideoAd({adUnitId:GameConst.rewardAdId}),this.rewardAd.onLoad(function(){console.log("激励视频 广告加载成功")}),this.rewardAd.onError(function(t){platform.toast("广告拉取失败，请稍后尝试")}),this.rewardAd.onClose(function(e){var n;n=e&&e.isEnded||void 0===e?0:1,t.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,n)}))},e.prototype.showRewardAd=function(t){var e=this;if(this.adtype=t,null!=this.rewardAd)try{this.rewardAd.show()["catch"](function(t){e.toast("广告加载失败"),e.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)})}catch(n){this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)}else this.dispatchGameEvent(GameEvent.REWARDAD_CLOSE_EVENT,2)},e.prototype.dispatchGameEvent=function(t,e){console.log("dispatchGameEvent:",t,this.adtype,e),t==GameEvent.REWARDAD_CLOSE_EVENT&&2==e&&this.toast("暂无视频可观看，过会再来看看吧");var n=new GameEvent(t);n.data={type:this.adtype,data:e},this.dispatchEvent(n)},e}(egret.EventDispatcher);__reflect(WxApi.prototype,"WxApi");var GameTrainLogic=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){},e.prototype.setNextMission=function(t,e,n){var i=this.data[t];if(null!=i){var r=i[e];null!=r&&(r.state=n)}},e.prototype.initData=function(){this.data=[,[],[],[]],this.config=RES.getRes("config_json");for(var t in this.config){var e=this.config[t];if(!(t.length<8)){var n=new TrainMissionVO;n.id=e.id,n.type=e.type,n.des=e.des,n.content=e.content,n.name=e.name,n.times=[];for(var i=e.time.split(":"),r=0;r<i.length;r++)n.times.push(parseInt(i[r]));n.state=1==n.type?0:1,1==n.type&&1==n.id&&(n.state=1),n.stars=0;var s=this.data[n.type][n.id-1];null!=s&&2==s.state&&(n.state=1),this.data[n.type].push(n)}}},e.prototype.getRecond=function(t){var e=0,n=GameLogic.getInstance().getMyDataValueByID(MYDATA.BEST_SCORE);if(null==n)e=0;else{var i=n.split("&");t:for(var r=0;r<i.length;r++){var s=i[r].split("=");if(t+""==s[0]){e=parseInt(s[1]);break t}}}return e},e.prototype.setRecond=function(t,e,n){var i=t+"="+e,r=GameLogic.getInstance().getMyDataValueByID(MYDATA.BEST_SCORE);null==r?r=i:r+="&"+i,GameLogic.getInstance().updateMyDataValue(MYDATA.BEST_SCORE,r),WxApi.getInstance().setScore(n,t,e)},e.prototype.openStart=function(){fw.UIManager.getInstance().openUI(UIConst.START)},e.prototype.startGame=function(t){fw.UIManager.getInstance().openUI(UIConst.GAME,t)},e.prototype.openMission=function(){fw.UIManager.getInstance().openUI(UIConst.MISSION)},e.prototype.openGrow=function(){fw.UIManager.getInstance().openUI(UIConst.GROW)},e.prototype.getMissionData=function(){return this.data},e.prototype.getStartMission=function(){return this.data[1][2]},e.prototype.getStringByStar=function(t){return this.config["str"+t]},e}(egret.EventDispatcher);__reflect(GameTrainLogic.prototype,"GameTrainLogic");var MissionTrainLogic=function(t){function e(){var e=t.call(this)||this;return e.charpters={},e.crtChapter=1,e.crtMission=101,e}return __extends(e,t),e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.initData=function(){this.initPassData(),GameTrainLogic.getInstance().initData(),this.initCharpter()},e.prototype.initPassData=function(){this.passdata={};var t=GameLogic.getInstance().getMyDataValueByID(MYDATA.MISSION_DATA);if(null!=t)for(var e=t.split("&"),n=0;n<e.length;n++){var i=e[n].split("=");this.passdata[i[0]]=parseInt(i[1])}},e.prototype.updatePassData=function(t,e){this.passdata[t]=e;var n="";for(var i in this.passdata)""!=n&&(n+="&"),n+=i+"="+this.passdata[i];GameLogic.getInstance().updateMyDataValue(MYDATA.MISSION_DATA,n)},e.prototype.getPassData=function(){return this.passdata},e.prototype.updateCrtMission=function(t){this.crtMission=t,GameLogic.getInstance().updateMyDataValue(MYDATA.MISSION_CRT,this.crtMission+"")},e.prototype.initCharpter=function(){var t=GameLogic.getInstance().getMyDataValueByID(MYDATA.MISSION_CRT);null==t?this.updateCrtMission(101):this.crtMission=parseInt(t),this.crtChapter=Math.floor(this.crtMission/100);var e=RES.getRes("mission_json"),n=this.crtMission%100;for(var i in e){var r=e[i],s=new CharpterMissionVO;s.missionId=parseInt(r.id),s.title=r.title,s.type=parseInt(r.type),s.content=r.content,s.des=r.des,s.times=r.time.split(":"),s.setDialog(r.dialog);var o=Math.floor(parseInt(i)/100),a=this.charpters[o];null==a&&(a=new CharpterVO,a.id=o,a.missions=[],o==this.crtChapter?(a.state=1,s.state=n<s.missionId?2:n>s.missionId?0:1):a.state=o<this.crtChapter?2:0),a.missions.push(s),this.charpters[o]=a}},e.prototype.getChaprters=function(){return this.charpters},e.prototype.getMissionsByChapterID=function(t){var e=this.charpters[t];return e.missions},e.prototype.getCrtMissionInCharpter=function(t){var e=this.charpters[t],n=Math.floor(this.crtMission/100);return n==t?this.crtMission%100:e.missions.length},e.prototype.startMissionGame=function(t){var e=egret.getDefinitionByName("GameUI"+t.type);fw.UIManager.getInstance().main.addChild(new e(t))},e}(egret.EventDispatcher);__reflect(MissionTrainLogic.prototype,"MissionTrainLogic");var BuryingPoint=function(){function t(){}return t.bp_grouprank_click="bp_grouprank_click",t}();__reflect(BuryingPoint.prototype,"BuryingPoint");var DataBase=function(){function t(){}return t.COIN_NAME=[,"体力","金币","钻石","","","","","","",""],t.HP_REDUCE_BATTLE=10,t.REWARD_ADD_SIGNIN="1:50;2:1000;3:10",t.HP_ADD_INVITE=100,t}();__reflect(DataBase.prototype,"DataBase");var GameConst=function(){function t(){}return t.version="1.10",t.notice_content="2018.11.10更新内容：\n1，增加世界排行榜；\n2，增加体力，用户关卡挑战\n3，增加每日签到，用户可以签到获取体力\n4，增加关卡模式，挑战可以获得成就及金币，后续可以购买商品\n\n\n如果您有什么建议，请点击左侧游戏圈发帖，谢谢！\n",t.bannerId="adunit-758f00e035da3372",t.rewardAdId="adunit-922e89b51b9d9336",t.localdata_key_reward_cd="rewardadcd",t.localdata_key_turn="_turn",t.localdata_key_lastlogintime="_lastlogintime",t}();__reflect(GameConst.prototype,"GameConst");var PROPTYPE;!function(t){t[t.COIN=1]="COIN",t[t.PROP=2]="PROP"}(PROPTYPE||(PROPTYPE={}));var COINTYPE;!function(t){t[t.HP=1]="HP",t[t.MONEY=2]="MONEY",t[t.DIAMOND=3]="DIAMOND"}(COINTYPE||(COINTYPE={}));var SWITCHTYPE;!function(t){t[t.ACHIEVE=1]="ACHIEVE",t[t.MISSION=2]="MISSION",t[t.SKIN=3]="SKIN",t[t.TURN=4]="TURN"}(SWITCHTYPE||(SWITCHTYPE={}));var MYDATA;!function(t){t[t.INVITE_GET=0]="INVITE_GET",t[t.REWARD_NUM=1]="REWARD_NUM",t[t.BEST_SCORE=2]="BEST_SCORE",t[t.INVITE_NUM=3]="INVITE_NUM",t[t.ACHIEVE_GET=4]="ACHIEVE_GET",t[t.CURRENT_SKIN=5]="CURRENT_SKIN",t[t.MISSION_CRT=6]="MISSION_CRT",t[t.MISSION_DATA=7]="MISSION_DATA",t[t.VERSION=8]="VERSION"}(MYDATA||(MYDATA={}));var WATCHTYPE;!function(t){t[t.TURNPLAY=1]="TURNPLAY"}(WATCHTYPE||(WATCHTYPE={}));var ACHIEVETYPE;!function(t){t[t.LOGIN_TOTAL=1]="LOGIN_TOTAL",t[t.SCORE_SINGLE=2]="SCORE_SINGLE",t[t.INVITE_NUM=3]="INVITE_NUM",t[t.REWARDAD_NUM=4]="REWARDAD_NUM"}(ACHIEVETYPE||(ACHIEVETYPE={}));var PlayerConst=function(){function t(){}return t.userInfo=new UserInfo,t.checkInfo=new CheckInVO,t.settingInfo=new SettingVO,t.noticeInfo=new NoticeVO,t}();__reflect(PlayerConst.prototype,"PlayerConst");var UIConst=function(){function t(){}return t.START="StartUI",t.GAME="GameUI",t.NOTICE="NoticeUI",t.RANK="RankUI",t.TURN="TurnUI",t.INVITE="InviteUI",t.GROW="GrowUI",t.MISSION="MissionUI",t.ACHIEVE="AchieveUI",t.command_getnext="nextscore",t.command_exceed="exceed",t.command_nearfriend="near",t.command_exceedfriend="exceedfriend",t.command_openrank="openrank",t.command_clear="clear",t}();__reflect(UIConst.prototype,"UIConst");var EffectUtil=function(){function t(){}return t.Center=function(t){t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.width==GameConst.stageWidth?t.x=t.width/2:t.parent.width<GameConst.stageWidth?t.x=t.parent.width/2:t.x=GameConst.stageWidth/2,t.height==GameConst.stageHeight?t.y=t.height/2:t.parent.height<GameConst.stageHeight?t.y=t.parent.height/2:t.y=GameConst.stageHeight/2},t.Clear=function(t){if(null!=t){for(var e=0;e<t.numChildren;e++){var n=t.getChildAt(e);egret.Tween.removeTweens(n)}egret.Tween.removeTweens(t),t.filters&&(t.filters=null)}},t.List=function(t,e){if(void 0===e&&(e=0),null!=t)for(var n=0;n<t.numChildren;n++){var i=t.getChildAt(n);i.y-=10,i.alpha=0,egret.Tween.get(i).wait(100*n+e).to({y:i.y+10,alpha:1},100)}},t.RollV=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=!0),!(null==t||0==t.numChildren||0>e||e>=t.numChildren)){var r=t.parent,s=t.getChildAt(e),o=(r.height-s.height)/2,a=s.y-o,c=null!=t.layout.gap?t.layout.gap:0,h=(s.height+c)*t.numChildren-c;h<=r.height||(0>a?a=0:a>h-r.height&&(a=h-r.height),r.stopAnimation(),i?egret.Tween.get(r.viewport).wait(n).to({scrollV:a},500,egret.Ease.circOut):r.viewport.scrollV=a)}},t.RollH=function(t,e,n,i,r){if(void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=!0),!(null==t||0==t.numChildren||0>e||e>=t.numChildren)){var s=t.parent,o=t.getChildAt(e),a=(s.width-o.width)/2,c=o.x-a,h=null!=t.layout.gap?t.layout.gap:0,l=(o.width+h)*t.numChildren-h;l<=s.width||(0>c?c=0:c>l-s.width&&(c=l-s.width+i),s.stopAnimation(),r?egret.Tween.get(s.viewport).wait(n).to({scrollH:c},500,egret.Ease.circOut):s.viewport.scrollH=c)}},t.Open=function(e,n,i){function r(){n&&n.call(i)}void 0===n&&(n=null),void 0===i&&(i=null),null!=e&&(t.Center(e),e.scaleX=e.scaleY=.1,egret.Tween.get(e).to({scaleX:1,scaleY:1,alpha:1},300,egret.Ease.backOut).call(r))},t.Close=function(t,e,n){function i(){e&&e.call(n)}void 0===e&&(e=null),void 0===n&&(n=null),null!=t&&(t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,egret.Tween.get(t).to({scaleX:.5,scaleY:.5},100).call(i))},t.FadeIn=function(t,e,n){void 0===e&&(e=500),void 0===n&&(n=0),null!=t&&(t.alpha=0,egret.Tween.get(t).wait(n).to({alpha:1},e))},t.FadeOut=function(t,e,n){void 0===e&&(e=500),void 0===n&&(n=0),null!=t&&egret.Tween.get(t).wait(n).to({alpha:0},e)},t.Big=function(t,e){void 0===e&&(e=0),null!=t&&(0==t.anchorOffsetX&&(t.x+=t.width/2),0==t.anchorOffsetY&&(t.y+=t.height/2),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,t.scaleX=t.scaleY=.8,egret.Tween.get(t).wait(e).to({scaleX:1,scaleY:1},500))},t.small=function(t,e,n,i){function r(){n&&n.call(i)}void 0===e&&(e=500),null!=t&&(0==t.anchorOffsetX&&(t.x+=t.width/2),0==t.anchorOffsetY&&(t.y+=t.height/2),t.anchorOffsetX=t.width/2,t.anchorOffsetY=t.height/2,egret.Tween.get(t).to({scaleX:0,scaleY:0},e).call(r))},t.Float=function(t){function e(){egret.Tween.get(t).to({y:t.y+10},n).call(function(){egret.Tween.get(t).to({y:t.y-10},n).call(e)})}if(null!=t){var n=1500;e()}},t.breathe=function(t,e){function n(){egret.Tween.get(t).to({scaleX:.9,scaleY:.9},e).call(function(){egret.Tween.get(t).to({scaleX:1,scaleY:1},e).call(n)})}void 0===e&&(e=800),null!=t&&n()},t.Move=function(t,e,n,i){function r(){e&&e.call(n)}void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i={}),null!=t&&(null==i.x&&(i.x=t.x),null==i.y&&(i.y=t.y),egret.Tween.get(t).to({x:i.x,y:i.y},300,egret.Ease.circOut).call(r))},t.NumChange=function(t,e,n,i){void 0===i&&(i=500);var r={n:e};t.text=e.toString(),egret.Tween.get(r,{onChange:function(){t.text=Math.round(r.n).toString()}},this).to({n:n},i)},t.outAlphaScale=function(t,e,n,i,r){function s(){egret.Tween.get(t).to({scaleX:e,scaleY:e,alpha:.2},i).call(function(){egret.Tween.get(t).to({scaleX:n,scaleY:n,alpha:1},r).call(s)})}void 0===e&&(e=1.2),void 0===n&&(n=1),void 0===i&&(i=500),void 0===r&&(r=200),null!=t&&(egret.Tween.removeTweens(t),s())},t.clearTween=function(t){null!=t&&egret.Tween.removeTweens(t)},t}();__reflect(EffectUtil.prototype,"EffectUtil");var FilterUtil=function(){function t(){}return t.getGrayFilter=function(){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getColorFilter=function(){var t=[0,0,0,0,0,0,1,0,0,255,0,0,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getBlurFilter=function(){var t=new egret.BlurFilter(1,1);return[t]},t.getTxtFilter=function(t){return void 0===t&&(t=0),[new egret.GlowFilter(t,1,2,2,4,1,!1,!1)]},t.getDropFilter=function(){var t=3,e=45,n=0,i=1,r=0,s=0,o=1.5,a=1,c=!1,h=!1,l=new egret.DropShadowFilter(t,e,n,i,r,s,o,a,c,h);return[l]},t}();__reflect(FilterUtil.prototype,"FilterUtil");var GameUtil=function(){function t(){}return t.getGrayFilter=function(){var t=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],e=new egret.ColorMatrixFilter(t);return[e]},t.getRotation=function(t,e){var n=Math.abs(t.y-e.y),i=Math.abs(t.x-e.x),r=180*Math.atan2(i,n)/Math.PI;return e.x>t.x?e.y<t.y?r+=0:r=180-r:r=e.y<t.y?360-r:180+r,r},t.getRandomByWeight=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];for(var i=Math.floor(Math.random()*e),r=0,n=0;n<t.length;n++)if(n>0&&(i-=t[n-1]),i<t[n]){r=n;break}return r},t.showMessage=function(t){console.log("showMessage:",t)},t.CheckBtnContinuousClick=function(t,e){void 0===e&&(e=1),null==this.btnTimeDic&&(this.btnTimeDic={});var n=t.hashCode,i=this.btnTimeDic[n],r=(new Date).getTime(),s=null==i||r-i>1e3*e;return s&&(this.btnTimeDic[n]=r),s},t.between=function(t,e,n){void 0===n&&(n=2);var i=Math.random()*(e-t)+t;return 0==n?i:1==n?Math.floor(i):-1==n?Math.ceil(i):Math.floor(Math.random()*(e-t+1)+t)},t.shuffle=function(t){for(var e=t.slice(),n=[];;){var i=Math.floor(Math.random()*e.length);if(n.push(e[i]),e.splice(i,1),0==e.length)break}return n},t.getShape=function(t,e,n,i){void 0===t&&(t=640),void 0===e&&(e=960),void 0===n&&(n=0),void 0===i&&(i=.7);
var r=new egret.Shape;return r.graphics.beginFill(n,i),r.graphics.drawRect(0,0,t,e),r.graphics.endFill(),r.touchEnabled=!1,r},t.getRectShape=function(t,e,n,i,r,s){void 0===t&&(t=640),void 0===e&&(e=960),void 0===n&&(n=0),void 0===i&&(i=.7),void 0===r&&(r=0),void 0===s&&(s=0);var o=new egret.Shape;return o.graphics.beginFill(n,i),o.graphics.drawRoundRect(0,0,t,e,r,s),o.graphics.endFill(),o.touchEnabled=!1,o},t.dealNum=function(t,e){void 0===e&&(e=3);var n=Math.pow(10,e);return Math.round(t/n)},t.ParseTime2Format=function(t,e){function n(t){var e=t.toString();return 10>t&&(e="0"+t),e}void 0===e&&(e="h:m:s");var i=Math.floor(t/24/3600),r=Math.floor(t/3600%24),s=Math.floor(t%3600/60),o=t%3600%60;return-1!=e.indexOf("d")?e=e.replace(/d/g,n(i)):r+=24*i,-1!=e.indexOf("h")?e=e.replace(/h/g,n(r)):s+=60*r,-1!=e.indexOf("m")?e=e.replace(/m/g,n(s)):-1!=e.indexOf("h")?o+=60*s:o=t,-1!=e.indexOf("s")&&(e=e.replace(/s/g,n(o))),e},t.createTextField=function(t,e,n,i,r,s,o,a,c,h,l){void 0===o&&(o=16777215),void 0===a&&(a=30),void 0===c&&(c="SimHei"),void 0===h&&(h="center"),void 0===l&&(l="middle");var p=new egret.TextField;return null!=t&&(p.x=t),null!=e&&(p.y=e),null!=n&&(p.x=(n-r)/2),null!=i&&(p.y=(i-s)/2),null!=r&&(p.width=r),null!=s&&(p.height=s),p.textColor=o,p.size=a,p.fontFamily=c,p.textAlign=h,p.verticalAlign=l,p.touchEnabled=!1,p},t.createBitmap=function(t,e,n,i,r,s,o,a){void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=null),void 0===r&&(r=null),void 0===s&&(s=0),void 0===o&&(o=null),void 0===a&&(a=null);var c=new egret.Bitmap;null!=t&&(c.texture=RES.getRes(t)),null!=o&&(c.width=o),null!=a&&(c.height=a),s%3==1?c.anchorOffsetX=c.width/2:s%3==2&&(c.anchorOffsetX=c.width);var h=Math.floor(s/3);return 1==h?c.anchorOffsetY=c.height/2:2==h&&(c.anchorOffsetY=c.height),null!=e&&(c.x=e),null!=n&&(c.y=n),null!=i&&(c.x=(i-o)/2),null!=r&&(c.y=(r-a)/2),c},t.formatNameString=function(t){for(var e=0,n="",i=0;i<t.length;i++)if(t.charCodeAt(i)>127||94==t.charCodeAt(i)?e+=2:e++,n+=t.charAt(i),e>12&&i<t.length-1)return n+"..";return t},t.checkSpeName=function(t){for(var e="",n=0;n<t.length;){var i=t.charCodeAt(n),r=t.charAt(n);n++,i>=65024&&65039>=i||(e+=r)}return e},t}();__reflect(GameUtil.prototype,"GameUtil");var ObjectUtil=function(){function t(){}return t.delObjectProp=function(t){for(var e in t)delete t[e]},t.cloneObject=function(t){var e=egret.getQualifiedClassName(t),n=egret.getDefinitionByName(e),i=new n;if("function"==e)return i.constructor;for(var r in t)if("callBackList"!=r){if("function"==r)return;var s=t[r];if("number"==typeof s||"string"==typeof s||"boolean"==typeof s)i[r]=s;else{var e=egret.getQualifiedClassName(s);if(""==e)continue;i[r]=this.cloneObject(s)}}return i},t.getState=function(t,e){var n=!1;return 1<<e&t&&(n=!0),n},t.push_bit=function(t,e){return t<<e},t}();__reflect(ObjectUtil.prototype,"ObjectUtil");var StringUtil=function(){function t(){}return t.getSwfLangTextFlowVar=function(e,n){return(new egret.HtmlTextParser).parser(t.getSwfLangStrVar(e,n))},t.getSwfLangStrVarByID=function(e,n){if(null==DataBase.strings)return e;var i=DataBase.strings[e];return null==i?e:t.getSwfLangStrVar(i,n)},t.getSwfLangStrVar=function(e,n){var i,r,s;i=e.indexOf("{"),r=e.indexOf("}");for(var o,a,c,h,l=0;-1!=i&&-1!=r;){s=e.substring(i,r+1),o=e.indexOf("@",l);var p=parseInt(e.substring(o+1,e.indexOf(":",o)))-1;if(0/0==p)return"stringError:"+e;a=e.indexOf("!#[",l)+3,a>2&&(c=e.indexOf("]@",l),h=e.substring(a,c),n[p]=t.getSwfLangStr(h+n[p]));var u=n[p].toString();e=e.replace(s,u),l=i+u.length,i=e.indexOf("{",l),r=e.indexOf("}",l)}return e},t.getSwfLangStr=function(t){if(null==DataBase.strings)return t;var e=DataBase.strings[t];return null==e?t:e.toString()},t}();__reflect(StringUtil.prototype,"StringUtil");var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),GameConst.GameStage=this.stage,GameConst.stageWidth=this.stage.stageWidth,GameConst.stageHeight=this.stage.stageHeight,fw.UIManager.getInstance().main=this,egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),fw.UIManager.getInstance().showLoading(!0,fw.LOADINGTYPE.LOADING),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return e.sent(),[4,this.loadTheme()];case 2:return e.sent(),[4,RES.loadGroup("preload",0,fw.UIManager.getInstance().loadingView)];case 3:return e.sent(),[3,5];case 4:return t=e.sent(),console.error(t),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){fw.UIManager.getInstance().showLoading(!1),fw.GameManager.getInstance().init()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var ViewUtil=function(){function t(){}return t.drawBitmapFromDisObject=function(t,e,n){var i=new egret.RenderTexture;i.drawToTexture(t,e,n);var r=new egret.Bitmap(i);return r},t.shake=function(t,e,n,i){var r=this;if(void 0===e&&(e=1.5),void 0===n&&(n=.5),void 0===i&&(i=50),!this.isShake){this.isShake=!0;var s=new egret.Point(t.x,t.y),o=[0,0],a=0,c=egret.setInterval(function(){o[a%2]=a++%4<2?0:n,a>4*e+1&&(egret.clearInterval(c),a=0,r.isShake=!1),t.x=o[0]+s.x,t.y=o[1]+s.y},this,i)}},t.drawArrow=function(t,e){void 0===t&&(t=50),void 0===e&&(e=16776960);var n=new egret.Shape;return n.graphics.lineStyle(1,0,1),n.graphics.beginFill(16776960),n.graphics.moveTo(-t,-t/2),n.graphics.lineTo(0,-t/2),n.graphics.lineTo(0,-t),n.graphics.lineTo(t,0),n.graphics.lineTo(0,t),n.graphics.lineTo(0,t/2),n.graphics.lineTo(-t,t/2),n.graphics.lineTo(-t,-t/2),n.graphics.endFill(),n},t.getShape=function(t,e,n,i){void 0===t&&(t=640),void 0===e&&(e=960),void 0===n&&(n=0),void 0===i&&(i=.7);var r=new egret.Shape;return r.graphics.beginFill(n,i),r.graphics.drawRect(0,0,t,e),r.graphics.endFill(),r.touchEnabled=!1,r},t.getArtNum=function(t,e){for(var n=new egret.Sprite,i=0;i<e.length;){var r=RES.getRes(t+e.charAt(i)),s=new egret.Bitmap(r);s.x=n.width+1,s.y=-r.textureHeight/2,n.addChild(s)}return n},t.hitTest=function(t,e){var n=t.getBounds(),i=e.getBounds();return n.x=t.x,n.y=t.y,i.x=e.x,i.y=e.y,n.intersects(i)},t.isShake=!1,t}();__reflect(ViewUtil.prototype,"ViewUtil");var AchieveItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="AchieveItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGet,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.lbl_name.text=t.title;for(var e="",n=0;n<t.reward.length;n++){e.length>0&&(e+="");var i=t.reward[n].split(":");e+=PropLogic.getInstance().getPropNameByID(parseInt(i[0]))+" X"+parseInt(i[1]),n<t.reward.length-1&&(e+="\n")}this.lbl_reward.text=e,this.btn.label=0==t.state?"未达成":1==t.state?"领取":"已领取",this.btn.filters=1!=t.state?FilterUtil.getGrayFilter():null}},e.prototype.clickGet=function(){1==this.data.state&&(this.data.state=2,this.btn.label=0==this.data.state?"未达成":1==this.data.state?"领取":"已领取",AchieveLogic.getInstance().getReward(this.data.id))},e.prototype.clear=function(){this.btn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGet,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),this.data=null},e}(eui.ItemRenderer);__reflect(AchieveItemUI.prototype,"AchieveItemUI");var AchieveUI=function(t){function e(){return t.call(this,"AchieveSkin")||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){this.list.itemRenderer=AchieveItemUI,this.arr_data=new eui.ArrayCollection;var t=AchieveLogic.getInstance().getAllAchieves();for(var e in t)this.arr_data.addItem(t[e]);this.list.dataProvider=this.arr_data},e.prototype.initEvent=function(){},e.prototype.clickClose=function(){t.prototype.clickClose.call(this)},e.prototype.clear=function(){t.prototype.clear.call(this),this.list.dataProvider=null,this.arr_data=null},e}(fw.BaseUI);__reflect(AchieveUI.prototype,"AchieveUI"),window.AchieveUI=AchieveUI;var GameItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.end,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.begin=function(){this.rect_click.fillColor=GameTrainLogic.getInstance().crtClickStr==this.data.id?4389127:16711680,this.rect_click.visible=!0},e.prototype.end=function(){this.rect_click.visible=!1},e.prototype.clear=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.begin,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.end,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.dataChanged=function(){if(null!=this.data){var t=720/this.data.row;this.width=this.height=this.rect_bg.width=this.rect_bg.height=this.rect_click.width=this.rect_click.height=t-30,this.lbl.size=this.data.size,this.lbl.text=this.data.id+""}},e}(eui.ItemRenderer);__reflect(GameItemUI.prototype,"GameItemUI"),window.MissionItemUI=MissionItemUI;var GameOverUI=function(t){function e(e,n){var i=t.call(this,"GameOverSkin")||this;return i.vo=e,i.time=n,i}return __extends(e,t),e.prototype.initView=function(){for(var t=0,e=this.vo.times.length-1;e>=0;e--)this.time<=1e3*this.vo.times[e]&&(t++,this["star"+(this.vo.times.length-e)].source=RES.getRes("star_a_png"));this.vo.stars=t,t>0&&(this.vo.state=2,GameTrainLogic.getInstance().setNextMission(this.vo.type,this.vo.id,1)),console.log("gameover:",this.vo);var n=GameTrainLogic.getInstance().getRecond(this.vo.id);0!=n&&(this.lbl_best.text="历史最快成绩："+this.getText(n)),(0==n||this.time<n)&&GameTrainLogic.getInstance().setRecond(this.vo.id,this.time,this.vo.type),this.time<n&&(this.lbl_fast.visible=!0),this.lbl.text=GameTrainLogic.getInstance().getStringByStar(this.vo.stars),this.lbl_time.text="本局用时："+this.getText(this.time)},e.prototype.getText=function(t){var e=TimeUtil.ParseTime2Format(Math.floor(t/1e3),"m:s"),n=t%1e3,i="";return i=10>n?"00"+n:100>n?"0"+n:n+"",e+":"+i},e.prototype.initEvent=function(){this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e.prototype.clickRestart=function(){GameTrainLogic.getInstance().startGame(this.vo)},e.prototype.clickBack=function(){GameTrainLogic.getInstance().openStart()},e.prototype.clickShare=function(){var t="这次舒尔特注意力训练"+this.vo.name+"关卡我只用了"+this.getText(this.time)+"秒，快来挑战我吧";WxApi.getInstance().share(fw.SHARETYPE.CRTSCORE,t)},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e}(fw.BaseUI);__reflect(GameOverUI.prototype,"GameOverUI");var GameUI=function(t){function e(e){var n=t.call(this,"GameSkin")||this;return n.vo=e.params,n}return __extends(e,t),e.prototype.checkFit=function(){t.prototype.checkFit.call(this),platform.bannerdestroy(),this.img_1.height=GameConst.stageHeight},e.prototype.initData=function(){switch(this.arr_data=new eui.ArrayCollection,this.vo.type){case 1:this.initType1();break;case 2:this.initType2();break;case 3:this.initType3()}},e.prototype.initType1=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e=0;t>e;e++)this.arr.push(e+1+"");for(var n=Math.sqrt(t),i=this.shuffle(this.arr),r=60,e=0;e<i.length;e++)this.arr_data.addItem({id:i[e],row:n,size:r})},e.prototype.initType2=function(){var t=this.vo.content.indexOf(","),e=-1!=t?",":"";this.arr=this.vo.content.split(e);var n=this.shuffle(this.arr),i=60;2!=this.vo.type||8!=this.vo.id&&9!=this.vo.id||(i=48);for(var r=(this.vo.id<3||this.vo.id>8?5:4,0);r<n.length;r++)this.arr_data.addItem({id:n[r],row:(this.vo.id<3,5),size:i})},e.prototype.initType3=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e="",n=0;t>n;n++){var i=Math.floor(10*Math.random())+"";this.arr.push(i),e+=i}this.lbl_num.visible=!0,this.lbl_num.alpha=1,this.lbl_num.text=e;for(var r=60,n=0;10>n;n++)this.arr_data.addItem({id:n+"",row:5,size:r});this.list.visible=!1},e.prototype.shuffle=function(t){for(var e=t.slice(),n=[];;){var i=Math.floor(Math.random()*e.length);if(n.push(e[i]),e.splice(i,1),0==e.length)break}return n},e.prototype.initView=function(){this.lbl_des.text=this.vo.des,this.list.itemRenderer=GameItemUI,this.list.dataProvider=this.arr_data,this.btn_back.visible=!0},e.prototype.clickStart=function(){var t=this;if(this.gp.visible=!1,3==this.vo.type){egret.clearTimeout(this.timeId);var e=1e3*(parseInt(this.vo.content)-5);this.timeId=egret.setTimeout(function(){egret.Tween.get(t.lbl_num).to({alpha:0},3e3).call(function(){t.lbl_num.visible=!1,t.list.visible=!0,t.start()},t)},this,e)}else this.start()},e.prototype.start=function(){GameTrainLogic.getInstance().crtclick=0,GameTrainLogic.getInstance().crtClickStr=this.arr[GameTrainLogic.getInstance().crtclick],this.starttime=egret.getTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.enterframe,this)},e.prototype.gameover=function(){var t=egret.getTimer(),e=t-this.starttime;this.addChild(new GameOverUI(this.vo,e))},e.prototype.initEvent=function(){this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e.prototype.clickBack=function(){GameTrainLogic.getInstance().openStart()},e.prototype.itemClick=function(t){var e=(t.itemIndex,t.item.id);t.itemRenderer;GameTrainLogic.getInstance().crtClickStr==e&&(GameTrainLogic.getInstance().crtclick++,GameTrainLogic.getInstance().crtclick>=this.arr.length?this.gameover():GameTrainLogic.getInstance().crtClickStr=this.arr[GameTrainLogic.getInstance().crtclick])},e.prototype.enterframe=function(){var t=egret.getTimer(),e=t-this.starttime,n=TimeUtil.ParseTime2Format(Math.floor(e/1e3),"m:s"),i=e%1e3,r="";r=10>i?"00"+i:100>i?"0"+i:i+"",this.lbl_time.text=n+":"+r},e.prototype.clickMission=function(){fw.UIManager.getInstance().openUI(UIConst.MISSION)},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,GameTrainLogic.getInstance().crtclick=0,egret.clearTimeout(this.timeId),egret.Tween.removeTweens(this.lbl_num),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterframe,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e}(fw.BaseUI);__reflect(GameUI.prototype,"GameUI"),window.GameUI=GameUI;var GrowLeftItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GrowLeftItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){this.lbl.text="第"+t.id+"章",this.lbl_state.visible=1!=t.state,this.lbl_state.text=0==t.state?"未解锁":"通关",this.lbl_state.textColor=0==t.state?9436162:16244487,this.rect_state.visible=0==t.state},e.prototype.isSelected=function(t){this.rect_select.visible=t},e}(eui.ItemRenderer);__reflect(GrowLeftItemUI.prototype,"GrowLeftItemUI"),window.GrowLeftItemUI=GrowLeftItemUI;var GrowRightItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="GrowRightItemSkin",e}return __extends(e,t),e.prototype.setVO=function(t){this.initView(t)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.initView(t)}},e.prototype.initView=function(t){if(this.lbl_title.text=t.missionId+"."+t.title,null!=t.best?this.lbl_best.text="最好成绩："+TimeUtil.formatSecondT(t.best):this.lbl_best.text="",2==t.state)for(var e=1;5>=e;e++)this["star"+e].source=RES.getRes(e<=t.stars?"star_a_png":"star_b_png");this.rect_state.visible=0==t.state},e.prototype.isSelected=function(t){this.rect_select.visible=t},e}(eui.ItemRenderer);__reflect(GrowRightItemUI.prototype,"GrowRightItemUI"),window.GrowRightItemUI=GrowRightItemUI;var GrowUI=function(t){function e(){return t.call(this,"GrowSkin")||this}return __extends(e,t),e.prototype.initData=function(){this.list_left.itemRenderer=GrowLeftItemUI,this.arr_data_left=new eui.ArrayCollection,this.list_right.itemRenderer=GrowRightItemUI,this.arr_data_right=new eui.ArrayCollection},e.prototype.initView=function(){platform.bannershow(GameConst.bannerId),this.charpters=MissionTrainLogic.getInstance().getChaprters(),this.crtChapter=MissionTrainLogic.getInstance().crtChapter,this.initLeftList()},e.prototype.initLeftList=function(){this.arr_data_left.removeAll();for(var t in this.charpters)this.arr_data_left.addItem(this.charpters[t]);this.list_left.dataProvider=this.arr_data_left,this.list_left.validateNow(),this.list_left.selectedIndex=this.crtChapter-1,this.missions=MissionTrainLogic.getInstance().getMissionsByChapterID(this.crtChapter),this.crtMission=MissionTrainLogic.getInstance().getCrtMissionInCharpter(this.crtChapter),this.crtLeftItem=this.list_left.getElementAt(this.crtChapter-1),this.crtLeftItem.isSelected(!0),this.initRightList()},e.prototype.initRightList=function(){this.arr_data_right.removeAll();for(var t=0;t<this.missions.length;t++)this.arr_data_right.addItem(this.missions[t]);this.list_right.dataProvider=this.arr_data_right,this.list_right.validateNow(),this.list_right.selectedIndex=this.crtMission,this.clickMission=this.missions[this.crtMission],this.crtRightItem=this.list_right.getElementAt(this.crtMission-1),this.crtRightItem.isSelected(!0)},e.prototype.initEvent=function(){this.list_left.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemLeftClick,this),this.list_right.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemRightClick,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this)},e.prototype.clickStart=function(){null!=this.clickMission&&MissionTrainLogic.getInstance().startMissionGame(this.clickMission)},e.prototype.clickBack=function(){GameTrainLogic.getInstance().openStart()},e.prototype.itemLeftClick=function(t){var e=this.list_left.selectedItem;if(0!=e.state){null!=this.crtLeftItem&&this.crtLeftItem.isSelected(!1);var n=this.list_left.selectedIndex;this.crtLeftItem=this.list_left.getElementAt(n),this.crtLeftItem.isSelected(!0),this.missions=e.missions,this.crtMission=MissionTrainLogic.getInstance().getCrtMissionInCharpter(this.crtChapter),this.initRightList()}},e.prototype.itemRightClick=function(t){var e=this.list_right.selectedItem;if(0!=e.state){this.clickMission=e,null!=this.crtRightItem&&this.crtRightItem.isSelected(!1);var n=this.list_right.selectedIndex;this.crtRightItem=this.list_right.getElementAt(n),this.crtRightItem.isSelected(!0)}},e.prototype.clear=function(){t.prototype.clear.call(this),platform.bannerdestroy(),this.list_left.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemLeftClick,this),this.list_right.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemRightClick,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.list_left.dataProvider=null,this.list_right.dataProvider=null,this.arr_data_left=null,this.arr_data_right=null,this.charpters=null,this.missions=null,this.clickMission=null},e}(fw.BaseUI);__reflect(GrowUI.prototype,"GrowUI");var InviteItemUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="InviteItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btn_get.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGet,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this)},e.prototype.dataChanged=function(){if(null!=this.data){var t=this.data;this.lbl_name.text=t.name,this.lbl_num1.text=t.num1+"",platform.isdebug()||(this.img.source=t.avatarurl),this.btn_get.label=t.hasget?"已领取":"领取"}},e.prototype.clickGet=function(){this.data.hasget||(this.data.hasget=!0,this.btn_get.label=this.data.hasget?"已领取":"领取",InviteLogic.getInstance().getReward(this.data.uid))},e.prototype.clear=function(){this.btn_get.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickGet,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clear,this),this.data=null},e}(eui.ItemRenderer);__reflect(InviteItemUI.prototype,"InviteItemUI");var InviteUI=function(t){function e(){return t.call(this,"InviteSkin")||this}return __extends(e,t),e.prototype.initData=function(){HttpCommand.getInstance().getInvite()},e.prototype.initView=function(){this.list.itemRenderer=InviteItemUI},e.prototype.initEvent=function(){this.btn_invite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),HttpCommand.getInstance().addEventListener(HttpEvent.getInvite,this.getInviteResponse,this)},e.prototype.clickBtn=function(){WxApi.getInstance().share(fw.SHARETYPE.INVITE)},e.prototype.getInviteResponse=function(){this.invites=InviteLogic.getInstance().getInvites(),this.arr_data=new eui.ArrayCollection,this.invites=this.invites.concat(this.invites).concat(this.invites);for(var t=0;t<this.invites.length;t++)this.arr_data.addItem(this.invites[t]);this.list.dataProvider=this.arr_data},e.prototype.clear=function(){t.prototype.clear.call(this),this.btn_invite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),HttpCommand.getInstance().removeEventListener(HttpEvent.getInvite,this.getInviteResponse,this)},e}(fw.BaseUI);__reflect(InviteUI.prototype,"InviteUI"),window.InviteUI=InviteUI;var LogoUI=function(t){function e(){var e=t.call(this)||this;return e.logo_src="logo_png",e.logo_txt="Domore Games\nGames can do more",e.init(),e}return __extends(e,t),e.prototype.init=function(){var t=this;this.addChild(GameUtil.getShape(GameConst.stageWidth,GameConst.stageWidth,8947848,.2)),this.logo=new egret.Bitmap(RES.getRes(this.logo_src)),this.logo.anchorOffsetX=this.logo.width/2,this.logo.anchorOffsetY=this.logo.height/2,this.logo.x=GameConst.stageWidth/2,this.logo.y=this.logo.height/2+40,this.addChild(this.logo),this.tf=GameUtil.createTextField(null,650,GameConst.stageWidth,null,GameConst.stageWidth,null,3140115,50,"Comic Sans MS"),this.tf.lineSpacing=10,this.tf.multiline=this.tf.wordWrap=!0,this.tf.text=this.logo_txt,this.tf.y=GameConst.stageHeight/2+100,this.tf.alpha=0,this.addChild(this.tf),egret.Tween.get(this.logo).to({y:GameConst.stageHeight/2-100,scaleX:1,scaleY:1},500,egret.Ease.backInOut).wait(100).call(function(){egret.Tween.get(t.tf).to({alpha:1},500).wait(1e3).call(function(){fw.GameManager.getInstance().logoOver()},t)},this)},e}(egret.DisplayObjectContainer);__reflect(LogoUI.prototype,"LogoUI");var DebugPlatform=function(){function t(){}return t.prototype.isdebug=function(){return!0},t.prototype.initBuryingSDK=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("debug_initBuryingSDK"),[2]})})},t.prototype.buryingPoint=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log("debug_buryingPoint",t),[2]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{code:"1D1C1C1C1C1C181L1L181F1F1C1G1E1F1H1C"}]})})},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return PlayerConst.token="1D1C1C1C1C1C181L1L181F1F1C1G1E1F1H1C",[2,{nickName:"debug_nickName",avatarUrl:"resource/assets/logo.png",city:"sz",country:"CHZ",gender:1,language:"chinese",province:"js"}]})})},t.prototype.showShareMenu=function(){},t.prototype.share=function(t,e,n){console.log("debug_share",t,e,n)},t.prototype.onShareAppMessage=function(t,e,n){console.log("debug_onShareAppMessage",t,e,n)},t.prototype.updateShareMenu=function(t){console.log("debug_updateShareMenu",t)},t.prototype.getShareInfo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{encryptedData:"debug_encryptedData",iv:"debug_iv"}]})})},t.prototype.getLaunchOptionsSync=function(){return{info:{query:"debug_query"},shareTicket:"debug_shareTicket"}},t.prototype.createGameClubButton=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log("debug_createGameClubButton",t),[2]})})},t.prototype.vibrate=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return console.log("debug_vibrate",t),[2]})})},t.prototype.bannershow=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("debug_bannershow"),[2]})})},t.prototype.bannerdestroy=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("debug_bannerdestroy"),[2]})})},t.prototype.bannerhide=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return console.log("debug_bannerhide"),[2]})})},t.prototype.setStorageSync=function(t,e,n){"string"!=typeof e&&(e=JSON.stringify(e)),console.log("setStorageSync:",t,e),egret.localStorage.setItem(t,e)},t.prototype.getStorageSync=function(t,e){var n=egret.localStorage.getItem(t);return n=JSON.parse(n),console.log("getStorageSync:",t,n),n},t.prototype.skipToProgram=function(t,e){console.log("debug_postMessage",t,e)},t.prototype.rewardAdCreate=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,1]})})},t.prototype.rerwardAdShow=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,2]})})},t.prototype.postMessage=function(t){console.log("debug_postMessage",t)},t.prototype.setUserCloudStorage=function(t){console.log("debug_setUserCloudStorage",t)},t.prototype.openCustomerServiceConversation=function(){console.log("debug_openCustomerServiceConversation")},t.prototype.toast=function(t){console.log("debug_toast:",t)},t.prototype.showModal=function(t,e,n){console.log("debug_showModal:",e,t,n)},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var MissionUI=function(t){function e(){return t.call(this,"MissionSkin")||this}return __extends(e,t),e.prototype.initData=function(){this.list.itemRenderer=MissionItemUI,this.arr_data=new eui.ArrayCollection},e.prototype.initView=function(){this.data=GameTrainLogic.getInstance().getMissionData(),this.crttype=1,this.initList(3);var t=this.gp_1.y;egret.Tween.get(this.gp_1,{loop:!0}).to({y:t-30},500).to(100).to({y:t},500).wait(300),platform.bannershow(GameConst.bannerId)},e.prototype.initList=function(t){void 0===t&&(t=null);var e=this.data[this.crttype];if(null!=e&&0!=e.length){this.arr_data.removeAll();for(var n=0;n<e.length;n++)this.arr_data.addItem(e[n]);this.list.dataProvider=this.arr_data,this.initBtn(),null!=t&&(this.list.validateNow(),this.list.selectedIndex=t)}},e.prototype.initEvent=function(){this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this);for(var t=1;3>=t;t++)this["btn"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this);this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this)},e.prototype.clickBack=function(){fw.UIManager.getInstance().openUI(UIConst.START)},e.prototype.btnClick=function(t){var e=parseInt(t.currentTarget.name);this.crttype!=e&&(this.crttype=e,this.initList(),this.gp_1.visible=1==e)},e.prototype.initBtn=function(){for(var t=1;3>=t;t++){var e=this["btn"+t];null!=e&&(e.filters=this.crttype!=t?FilterUtil.getGrayFilter():null)}},e.prototype.itemClick=function(t){var e=t.itemIndex,n=this.data[this.crttype];if(null!=n&&0!=n.length){var i=n[e];null!=i&&fw.UIManager.getInstance().openUI(UIConst.GAME,i)}},e.prototype.clear=function(){t.prototype.clear.call(this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this);for(var e=1;3>=e;e++)this["btn"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this);this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),egret.Tween.removeTweens(this.gp_1),this.list.dataProvider=null,this.arr_data=null,this.list=null,this.data=null,platform.bannerdestroy()},e}(fw.BaseUI);__reflect(MissionUI.prototype,"MissionUI"),window.MissionUI=MissionUI;var NoticeUI=function(t){function e(){return t.call(this,"NoticeSkin")||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){this.lbl_content.text=PlayerConst.noticeInfo.content,this.lbl_version.text="版本号："+PlayerConst.noticeInfo.version_server},e.prototype.initEvent=function(){this.img_bg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this)},e.prototype.clear=function(){t.prototype.clear.call(this),this.img_bg.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickClose,this)},e}(fw.BaseUI);__reflect(NoticeUI.prototype,"NoticeUI"),window.NoticeUI=NoticeUI;var StartUI=function(t){function e(){return t.call(this,"StartSkin")||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){this.updateHp(),this.updateCheckIn(),platform.bannershow(GameConst.bannerId)},e.prototype.initEvent=function(){for(var t=0;9>t;t++)this["btn_"+t].addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this);this.btn_mission.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_grow.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_ad.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_sign.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_turn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_invite.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_achieve.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_rank.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),HttpCommand.getInstance().addEventListener(HttpEvent.checkIn,this.updateCheckIn,this),PropLogic.getInstance().addEventListener(GameEvent.PROP_NUM_CHANGE,this.propChange,this)},e.prototype.updateHp=function(){var t=PropLogic.getInstance().getPropByID(COINTYPE.HP);this.lbl_hp.text="体力："+(null==t?"0":t.num)},e.prototype.updateCoin=function(){var t=PropLogic.getInstance().getPropByID(COINTYPE.MONEY);
this.lbl_coin.text="金币："+(null==t?"0":t.num)},e.prototype.updateDiamond=function(){var t=PropLogic.getInstance().getPropByID(COINTYPE.DIAMOND);this.lbl_diamond.text="钻石："+(null==t?"0":t.num)},e.prototype.propChange=function(t){switch(t.data.id){case COINTYPE.HP:this.updateHp();break;case COINTYPE.MONEY:this.updateCoin();break;case COINTYPE.DIAMOND:this.updateDiamond()}},e.prototype.updateCheckIn=function(){this.btn_sign.label=PlayerConst.checkInfo.signed_today?"已签到":"每日签到"},e.prototype.clickBtn=function(t){switch(t.currentTarget){case this.btn_ad:WxApi.getInstance().showRewardAd(1);break;case this.btn_mission:fw.UIManager.getInstance().openUI(UIConst.MISSION);break;case this.btn_grow:fw.UIManager.getInstance().openUI(UIConst.GROW);break;case this.btn_sign:GameLogic.getInstance().signIn();break;case this.btn_turn:fw.UIManager.getInstance().openUI(UIConst.TURN,null,fw.UITYPE.SECOND);break;case this.btn_invite:fw.UIManager.getInstance().openUI(UIConst.INVITE,null,fw.UITYPE.SECOND);break;case this.btn_achieve:fw.UIManager.getInstance().openUI(UIConst.ACHIEVE,null,fw.UITYPE.SECOND);break;case this.btn_rank:fw.UIManager.getInstance().openUI(UIConst.RANK,{shareticket:null,openworld:!1},fw.UITYPE.SECOND);break;case this.btn_share:WxApi.getInstance().share(fw.SHARETYPE.ACTIVE)}},e.prototype.clear=function(){t.prototype.clear.call(this);for(var e=0;8>e;e++)this["btn_"+e].removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this);this.btn_ad.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_mission.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_grow.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_sign.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_turn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_invite.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_achieve.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_rank.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),HttpCommand.getInstance().removeEventListener(HttpEvent.checkIn,this.updateCheckIn,this),PropLogic.getInstance().removeEventListener(GameEvent.PROP_NUM_CHANGE,this.propChange,this),platform.bannerdestroy()},e}(fw.BaseUI);__reflect(StartUI.prototype,"StartUI"),window.StartUI=StartUI;var TurnItemUI=function(t){function e(e,n){var i=t.call(this)||this;return i.skinName="TurnItemSkin",i.vo=n,i.index=e,i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.lbl.text=this.vo.name},e.prototype.selected=function(t){this.rect.fillColor=t?14521101:521455},e.prototype.clear=function(){this.vo=null},e}(eui.Component);__reflect(TurnItemUI.prototype,"TurnItemUI");var TurnUI=function(t){function e(){var e=t.call(this,"TurnSkin")||this;return e.crtIndex=0,e}return __extends(e,t),e.prototype.initData=function(){this.turnItems=[],this.weights=[],HttpCommand.getInstance().getTurntable()},e.prototype.initView=function(){this.rewardCD()},e.prototype.updateVideoCD=function(){var t=WxApi.getInstance().getRewardCD();this.btn_1.touchEnabled=0>=t,this.btn_1.filters=0>=t?null:FilterUtil.getGrayFilter(),this.can1=0>=t,t>0?this.lbl_cd1.text=GameUtil.ParseTime2Format(t):this.lbl_cd1.text=""},e.prototype.updateFreeCD=function(){var t=TurnLogic.getInstance().getFreeShareCD();this.btn_2.touchEnabled=0>=t,this.btn_2.filters=0>=t?null:FilterUtil.getGrayFilter(),this.can2=0>=t,t>0?this.lbl_cd2.text=GameUtil.ParseTime2Format(t):this.lbl_cd2.text=""},e.prototype.initEvent=function(){this.btn_1.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_2.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),WxApi.getInstance().addEventListener(GameEvent.REWARDAD_CLOSE_EVENT,this.watchReward,this),HttpCommand.getInstance().addEventListener(HttpEvent.getTurntable,this.turnResponse,this),TimerManager.getInstance().addTimerCallBack(this.rewardCD,this)},e.prototype.rewardCD=function(){this.updateVideoCD(),this.updateFreeCD()},e.prototype.watchReward=function(t){t.data.type==WATCHTYPE.TURNPLAY&&0==t.data.data&&(this.play(),this.updateVideoCD())},e.prototype.clickBtn=function(t){if(null!=this.turns)switch(t.currentTarget){case this.btn_1:this.turnPlay();break;case this.btn_2:this.freePlay()}},e.prototype.turnPlay=function(){this.isplaying||WxApi.getInstance().showRewardAd(WATCHTYPE.TURNPLAY)},e.prototype.freePlay=function(){this.isplaying||this.can2&&TurnLogic.getInstance().freetimes>0&&(this.play(),TurnLogic.getInstance().setFreeTurn(),this.updateFreeCD())},e.prototype.play=function(){var t=this;this.isplaying=!0,this.count=this.crtIndex;var e=4,n=this.turnItems.length*e,i=GameUtil.getRandomByWeight(this.weights),r=n+i;egret.Tween.get(this,{onChange:this.update,onChangeObj:this}).to({count:r},5e3,egret.Ease.quadInOut).call(function(){t.isplaying=!1,t.getReward()},this)},e.prototype.update=function(){var t=Math.ceil(this.count)%this.turnItems.length;this.crtIndex!=t&&(this.crtIndex=t,null!=this.crtItem&&this.crtItem.selected(!1),this.crtItem=this.turnItems[t],this.crtItem.selected(!0))},e.prototype.getReward=function(){null!=this.crtItem&&WxApi.getInstance().toast("获得奖励："+this.crtItem.vo.name)},e.prototype.turnResponse=function(){this.turns=TurnLogic.getInstance().getTurnVOs(),this.updateTurns()},e.prototype.updateTurns=function(){for(var t=this.turns.length/4,e=124,n=0;n<this.turns.length;n++){var i=this.turns[n],r=new TurnItemUI(n,i),s=Math.floor(n/t);0==s?(r.x=e*n,r.y=0):1==s?(r.x=e*t,r.y=e*(n-t)):2==s?(r.x=e*(3*t-n),r.y=e*t):(r.x=0,r.y=e*(4*t-n)),this.gp_items.addChild(r),this.turnItems.push(r),this.weights.push(i.weight)}},e.prototype.clickClose=function(){this.isplaying||t.prototype.clickClose.call(this)},e.prototype.clear=function(){t.prototype.clear.call(this),this.btn_1.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),this.btn_2.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBtn,this),WxApi.getInstance().removeEventListener(GameEvent.REWARDAD_CLOSE_EVENT,this.watchReward,this),HttpCommand.getInstance().removeEventListener(HttpEvent.getTurntable,this.turnResponse,this),TimerManager.getInstance().removeFun(this.rewardCD,this),this.isplaying=!1},e}(fw.BaseUI);__reflect(TurnUI.prototype,"TurnUI"),window.TurnUI=TurnUI;var AVGLogic=function(){function t(){}return t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t.prototype.startAVG=function(t,e){},t.prototype.getAVGVOByID=function(t){return this.avg_data_arr[t-1]},t.prototype.iniData=function(){this.avg_data_arr=[];for(var t=RES.getRes("avg_list_json"),e=0;e<t.length;e++){var n=new AvgVO,i=t[e];n.id=i.id,n.name=i.name,n.bg=i.bg,n.dialogs=this.getDialog(i.dialog),this.avg_data_arr.push(n)}},t.prototype.getDialog=function(t){for(var e=[],n=0;n<t.length;n++){var i=new AvgDialogVO,r=t[n];i.head=r.head,i.words=r.words,i.bg=r.bg,i.name=r.name,i.is_left=0==r.pos,e.push(i)}return e},t.BEGIN_AVG=0,t.OVER_AVG=1,t}();__reflect(AVGLogic.prototype,"AVGLogic");var AvgMainUI=function(t){function e(e,n){var i=t.call(this)||this;return i.avg_type=n,i.vo=AVGLogic.getInstance().getAVGVOByID(e),i.skinName="AvgMainSkin",i}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.bg_img=new eui.Image(RES.getRes(this.vo.bg)),this.bg_img.bottom=0,this.bg.addChild(this.bg_img),this.finger=new eui.Image(RES.getRes("finger_png")),this.finger.smoothing=!0,this.finger.scaleX=this.finger.scaleY=.4,this.finger.right=120,this.finger.bottom=12,this.finger.visible=!1,this.addChild(this.finger),this.timer=new egret.Timer(100),this.timer.addEventListener(egret.TimerEvent.TIMER,this.delay,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dialogSubOver,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.click,this),this.current_dialog_index=0,this.start()},e.prototype.start=function(){this.finger.visible=!1,this.current_dialog=this.vo.dialogs[this.current_dialog_index],this.words_index=0,this.txt.text="",this.words=this.current_dialog.words.split(""),null==this.dialog_bg&&(this.dialog_bg=new eui.Image),this.dialog_bg_src!=this.current_dialog.bg&&(this.dialog_bg.texture=RES.getRes(this.current_dialog.bg)),null==this.head&&(this.head=new eui.Image),this.head.texture=RES.getRes(this.current_dialog.head),this.current_dialog.is_left?(this.head.left=150,this.head.right=null):(this.head.left=null,this.head.right=150),this.head.bottom=560,this.addChild(this.head),this.timer.start()},e.prototype.delay=function(){this.words_index>=this.words.length?this.dialogSubOver():(this.txt.text+=this.words[this.words_index],this.words_index++)},e.prototype.dialogSubOver=function(){this.timer.reset(),this.txt.text=this.current_dialog.words,this.finger.visible=!0},e.prototype.click=function(){this.timer.running?this.dialogSubOver():(this.current_dialog_index++,this.current_dialog_index>=this.vo.dialogs.length?this.over():this.start())},e.prototype.over=function(){null!=this.parent&&(this.parent.removeChild(this),this.clear())},e.prototype.clear=function(){this.timer.start(),this.timer.removeEventListener(egret.TimerEvent.TIMER,this.delay,this),this.timer.removeEventListener(egret.TimerEvent.TIMER_COMPLETE,this.dialogSubOver,this),this.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.click,this),this.current_dialog=null,this.vo=null},e}(eui.Component);__reflect(AvgMainUI.prototype,"AvgMainUI");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function r(t){e.call(i,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),n.call(i))}var o=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(i,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GamesOverUI=function(t){function e(e,n){var i=t.call(this,"GamesOverSkin")||this;return i.vo=e,i.time=n,i}return __extends(e,t),e.prototype.initView=function(){for(var t=0,e=this.vo.times.length-1;e>=0;e--)this.time<=1e3*this.vo.times[e]&&(t++,this["star"+(this.vo.times.length-e)].source=RES.getRes("star_a_png"));this.vo.stars=t,t>0&&(this.vo.state=2,GameTrainLogic.getInstance().setNextMission(this.vo.type,this.vo.id,1)),console.log("gameover:",this.vo);var n=GameTrainLogic.getInstance().getRecond(this.vo.id);0!=n&&(this.lbl_best.text="历史最快成绩："+this.getText(n)),(0==n||this.time<n)&&GameTrainLogic.getInstance().setRecond(this.vo.id,this.time,this.vo.type),this.time<n&&(this.lbl_fast.visible=!0),this.lbl.text=GameTrainLogic.getInstance().getStringByStar(this.vo.stars),this.lbl_time.text="本局用时："+this.getText(this.time)},e.prototype.getText=function(t){var e=TimeUtil.ParseTime2Format(Math.floor(t/1e3),"m:s"),n=t%1e3,i="";return i=10>n?"00"+n:100>n?"0"+n:n+"",e+":"+i},e.prototype.initEvent=function(){this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e.prototype.clickRestart=function(){GameTrainLogic.getInstance().startGame(this.vo)},e.prototype.clickBack=function(){GameTrainLogic.getInstance().openStart()},e.prototype.clickShare=function(){var t="这次舒尔特注意力训练"+this.vo.name+"关卡我只用了"+this.getText(this.time)+"秒，快来挑战我吧";WxApi.getInstance().share(fw.SHARETYPE.CRTSCORE,t)},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_restart.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickRestart,this),this.btn_share.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickShare,this)},e}(fw.BaseUI);__reflect(GamesOverUI.prototype,"GamesOverUI");var GameUI1=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.checkFit=function(){t.prototype.checkFit.call(this)},e.prototype.initData=function(){switch(this.arr_data=new eui.ArrayCollection,this.vo.type){case 1:this.initType1();break;case 3:this.initType3()}},e.prototype.initType1=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e=0;t>e;e++)this.arr.push(e+1+"");for(var n=Math.sqrt(t),i=this.shuffle(this.arr),r=60,e=0;e<i.length;e++)this.arr_data.addItem({id:i[e],row:n,size:r})},e.prototype.initType3=function(){var t=parseInt(this.vo.content);this.arr=[];for(var e="",n=0;t>n;n++){var i=Math.floor(10*Math.random())+"";this.arr.push(i),e+=i}this.lbl_num.visible=!0,this.lbl_num.alpha=1,this.lbl_num.text=e;for(var r=60,n=0;10>n;n++)this.arr_data.addItem({id:n+"",row:5,size:r});this.list.visible=!1},e.prototype.shuffle=function(t){for(var e=t.slice(),n=[];;){var i=Math.floor(Math.random()*e.length);if(n.push(e[i]),e.splice(i,1),0==e.length)break}return n},e.prototype.initView=function(){this.lbl_des.text=this.vo.des,this.list.itemRenderer=GameItemUI,this.list.dataProvider=this.arr_data,this.btn_back.visible=!0},e.prototype.clickStart=function(){var t=this;if(this.gp.visible=!1,3==this.vo.type){egret.clearTimeout(this.timeId);var e=1e3*(parseInt(this.vo.content)-5);this.timeId=egret.setTimeout(function(){egret.Tween.get(t.lbl_num).to({alpha:0},3e3).call(function(){t.lbl_num.visible=!1,t.list.visible=!0,t.start()},t)},this,e)}else this.start()},e.prototype.start=function(){GameTrainLogic.getInstance().crtclick=0,GameTrainLogic.getInstance().crtClickStr=this.arr[GameTrainLogic.getInstance().crtclick],this.starttime=egret.getTimer(),this.addEventListener(egret.Event.ENTER_FRAME,this.enterframe,this)},e.prototype.gameover=function(){var t=egret.getTimer(),e=t-this.starttime;this.addChild(new GameOverUI(this.vo,e))},e.prototype.initEvent=function(){this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.list.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.addEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e.prototype.clickBack=function(){GameTrainLogic.getInstance().openStart()},e.prototype.itemClick=function(t){var e=(t.itemIndex,t.item.id);t.itemRenderer;GameTrainLogic.getInstance().crtClickStr==e&&(GameTrainLogic.getInstance().crtclick++,GameTrainLogic.getInstance().crtclick>=this.arr.length?this.gameover():GameTrainLogic.getInstance().crtClickStr=this.arr[GameTrainLogic.getInstance().crtclick])},e.prototype.enterframe=function(){var t=egret.getTimer(),e=t-this.starttime,n=TimeUtil.ParseTime2Format(Math.floor(e/1e3),"m:s"),i=e%1e3,r="";r=10>i?"00"+i:100>i?"0"+i:i+"",this.lbl_time.text=n+":"+r},e.prototype.clickMission=function(){GameTrainLogic.getInstance().openMission()},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null,GameTrainLogic.getInstance().crtclick=0,egret.clearTimeout(this.timeId),egret.Tween.removeTweens(this.lbl_num),this.btn_start.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickStart,this),this.removeEventListener(egret.Event.ENTER_FRAME,this.enterframe,this),this.list.removeEventListener(eui.ItemTapEvent.ITEM_TAP,this.itemClick,this),this.btn_back.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickBack,this),this.btn_mission.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.clickMission,this)},e}(GameBaseUI);__reflect(GameUI1.prototype,"GameUI1");var GameUI2=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI2.prototype,"GameUI2");var GameUI3=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI3.prototype,"GameUI3");var GameUI4=function(t){function e(e){return t.call(this,"Game1Skin",e)||this}return __extends(e,t),e.prototype.initData=function(){},e.prototype.initView=function(){},e.prototype.initEvent=function(){},e.prototype.clear=function(){t.prototype.clear.call(this),this.vo=null},e}(GameBaseUI);__reflect(GameUI4.prototype,"GameUI4");var AchieveVO=function(){function t(){}return Object.defineProperty(t.prototype,"grade",{get:function(){return this._grade},set:function(t){this._grade=t},enumerable:!0,configurable:!0}),t}();__reflect(AchieveVO.prototype,"AchieveVO");var AvgDialogVO=function(){function t(){}return t}();__reflect(AvgDialogVO.prototype,"AvgDialogVO");var AvgVO=function(){function t(){}return t}();__reflect(AvgVO.prototype,"AvgVO");var CharpterMissionVO=function(){function t(){}return t.prototype.setDialog=function(t){},t}();__reflect(CharpterMissionVO.prototype,"CharpterMissionVO");var CharpterVO=function(){function t(){}return t}();__reflect(CharpterVO.prototype,"CharpterVO");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?i(r):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var InviteVO=function(){function t(){}return t}();__reflect(InviteVO.prototype,"InviteVO");var MissionVO=function(){function t(){}return Object.defineProperty(t.prototype,"grade",{get:function(){return this._grade},set:function(t){this._grade=t,this.star=this.getStarByGrade(t)},enumerable:!0,configurable:!0}),t.prototype.getStarByGrade=function(t){return null==this.times,0},t.prototype.setDialog=function(t){},t}();__reflect(MissionVO.prototype,"MissionVO");var MyDataVO=function(){function t(){}return t}();__reflect(MyDataVO.prototype,"MyDataVO");var PropVO=function(){function t(){this.extradata1="",this.extradata2=""}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this.type=10>t?PROPTYPE.COIN:PROPTYPE.PROP},enumerable:!0,configurable:!0}),t}();__reflect(PropVO.prototype,"PropVO");var SkinVO=function(){function t(){}return t}();__reflect(SkinVO.prototype,"SkinVO");var TrainMissionVO=function(){function t(){}return t}();__reflect(TrainMissionVO.prototype,"TrainMissionVO");var TurnVO=function(){function t(){}return t}();__reflect(TurnVO.prototype,"TurnVO");var TimeUtil=function(){function t(){}return t.checkToday=function(e){var n=Math.floor(t.getTodayZero()/1e3);return e>=n},t.getTodayZero=function(){var t=new Date,e=t.getHours(),n=t.getMinutes(),i=t.getSeconds(),r=3600*e+60*n+i;return t.getTime()-1e3*r},t.formatSecondT=function(e){var n=t.ParseTime2Format(Math.floor(e/1e3),"m:s"),i=e%1e3,r="";return r=10>i?"00"+i:100>i?"0"+i:i+"",n+":"+r},t.GetDayInYear=function(t){var e=new Date(t),n=e.getMonth()+1,i=e.getFullYear(),r=e.getDate(),s=0,o=[31,28,31,30,31,30,31,31,30,31,30,31],a=[31,29,31,30,31,30,31,31,30,31,30,31];if(i%400==0||i%4==0&&i%100!=0){for(var c=0;n-1>c;c++)s+=a[c];return s+r}for(var c=0;n-1>c;c++)s+=o[c];return s+r},t.getSecondInDay=function(t){return 3600*t.getHours()+60*t.getMinutes()+t.getSeconds()},t.ParseTime2Format=function(t,e){function n(t){var e=t.toString();return 10>t&&(e="0"+t),e}void 0===e&&(e="h:m:s");var i=Math.floor(t/24/3600),r=Math.floor(t/3600%24),s=Math.floor(t%3600/60),o=t%3600%60;return-1!=e.indexOf("d")?e=e.replace(/d/g,n(i)):r+=24*i,-1!=e.indexOf("h")?e=e.replace(/h/g,n(r)):s+=60*r,-1!=e.indexOf("m")?e=e.replace(/m/g,n(s)):-1!=e.indexOf("h")?o+=60*s:o=t,-1!=e.indexOf("s")&&(e=e.replace(/s/g,n(o))),e},t.ParseTime2Date=function(t,e){function n(t){var e=t.toString();return 10>t&&(e="0"+t),e}void 0===e&&(e="Y-M-D h:m:s");var i=new Date(t),r=i.getFullYear(),s=i.getMonth()+1,o=i.getDate(),a=i.getHours(),c=i.getMinutes(),h=i.getSeconds();return-1!=e.indexOf("Y")&&(e=e.replace(/Y/g,n(r))),-1!=e.indexOf("M")&&(e=e.replace(/M/g,n(s))),-1!=e.indexOf("D")&&(e=e.replace(/D/g,n(o))),-1!=e.indexOf("h")&&(e=e.replace(/h/g,n(a))),-1!=e.indexOf("m")&&(e=e.replace(/m/g,n(c))),-1!=e.indexOf("s")&&(e=e.replace(/s/g,n(h))),e},t.ParseTimeChangeToUtil=function(t){var e="";return t>=86400?e=Math.floor(t/86400)+"天":t>=3600?e=Math.floor(t/3600)+"小时":t>=60?e=Math.floor(t/60)+"分钟":60>t&&t>0&&(e=t+"秒"),e},t.ParseTime2Units=function(t,e){void 0===e&&(e="h");var n="";if("d"==e)n=Math.ceil(t/86400)+"天";else if("h"==e)n=Math.ceil(t/3600)+"小时";else if("m"==e)n=Math.ceil(t/60)+"分钟";else if("s"==e)n=t+"秒";else{var i=Math.floor(t/86400),r=Math.floor(t/3600),s=Math.floor(t/60),o=t%60;n=i+"天"+r+"时"+s+"分"+o+"秒"}return n},t.CreateCD=function(t,e,n,i){void 0===i&&(i=0);var r=new egret.Timer(n,i);return r.addEventListener(egret.TimerEvent.TIMER,t,e),r},t.RemoveCD=function(t,e,n){null!=t&&(t.stop(),t.removeEventListener(egret.TimerEvent.TIMER,e,n))},t}();__reflect(TimeUtil.prototype,"TimeUtil"),window.Main=Main;